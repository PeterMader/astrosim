<<<<<<< HEAD
"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var _slicedToArray=function(){function e(e,t){var i=[];var n=true;var o=false;var a=undefined;try{for(var s=e[Symbol.iterator](),r;!(n=(r=s.next()).done);n=true){i.push(r.value);if(t&&i.length===t)break}}catch(e){o=true;a=e}finally{try{if(!n&&s["return"])s["return"]()}finally{if(o)throw a}}return i}return function(t,i){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,i,n){if(i)e(t.prototype,i);if(n)e(t,n);return t}}();function _possibleConstructorReturn(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}(function e(t,i,n){function o(s,r){if(!i[s]){if(!t[s]){var l=typeof require=="function"&&require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return o(i?i:e)},u,u.exports,e,t,i,n)}return i[s].exports}var a=typeof require=="function"&&require;for(var s=0;s<n.length;s++){o(n[s])}return o})({1:[function(e,t,i){var n=e("../astrosim.js");var o=e("./loop.js");var a=n.mainLoop;var s=e("../content/vec2.js");var r=void 0;var l=t.exports=n.animation={MIN_SCALING:2e-10,MAX_SCALING:2e10,translation:s.create(0,0),ratio:1,size:0,width:0,height:0,canvas:null,textCanvas:null,ctx:null,textCtx:null,frames:0,framesPerSecond:0,traceFrequency:10,shouldRender:true,drawHistory:true,drawControls:true,drawLabels:false,dragging:false,draggingPositionStart:s.create(),draggingPositionEnd:s.create(),draggingRadius:1,draggingCenter:false,draggingColor:"#FFFFFF",mouseHeld:false,animationLoop:new o(function(){if(l.shouldRender){l.render();l.renderControls();l.shouldRender=false}else if(a.running){if(l.frames%3===0){l.render()}if(l.frames%30===0){l.renderControls()}l.frames+=1}}),adjust:function e(){this.width=this.canvas.width=this.textCanvas.width=window.innerWidth;this.height=this.canvas.height=this.textCanvas.height=window.innerHeight;this.translation[0]=0;this.translation[1]=0;this.ratio=1;this.shouldRender=true},initialize:function t(){var i=this.canvas=document.getElementById("canvas");var n=this.textCanvas=document.getElementById("text-canvas");this.ctx=i.getContext("2d",{alpha:false});this.textCtx=n.getContext("2d");this.adjust();r=e("../ui/ui.js");e("./transformation.js");e("./render.js");e("./event-listeners.js")();this.animationLoop.start()},pause:function e(){a.pause()},unpause:function e(){a.unpause()}}},{"../astrosim.js":7,"../content/vec2.js":12,"../ui/ui.js":36,"./event-listeners.js":3,"./loop.js":4,"./render.js":5,"./transformation.js":6}],2:[function(e,t,i){t.exports=function(){function e(t,i,n){_classCallCheck(this,e);this.r=e.getInt(t||0);this.g=e.getInt(i||0);this.b=e.getInt(n||0)}_createClass(e,[{key:"copy",value:function t(){return new e(this.r,this.g,this.b)}},{key:"interpolate",value:function t(i){if(!(i instanceof e)){return this.copy()}var n=(this.r+i.r)/2;var o=(this.g+i.g)/2;var a=(this.b+i.b)/2;return new e(n,o,a)}},{key:"hexString",value:function t(){var i=e.decToHex(this.r);var n=e.decToHex(this.g);var o=e.decToHex(this.b);return"#"+i+n+o}}],[{key:"fromHexString",value:function t(i){var n=e.hexToDec(i.slice(1,3));var o=e.hexToDec(i.slice(3,5));var a=e.hexToDec(i.slice(5,7));return new e(n,o,a)}},{key:"getInt",value:function t(i){var n=i;if(typeof i==="string"){n=e.hexToDec(i)}if(typeof n!=="number"){return 0}if(n>255){return 255}if(n<0){return 0}return Math.round(n)}},{key:"decToHex",value:function e(t){var i=t.toString(16);return i.length<2?"0"+i:i}},{key:"hexToDec",value:function e(t){return parseInt(t,16)}}]);return e}()},{}],3:[function(e,t,i){var n=e("./animation.js");var o=e("../astrosim.js"),a=o.mainLoop;var s=e("../ui/dialogs/dialog-manager.js");var r=e("../ui/ui.js");t.exports=function(){var e=n.textCanvas;window.addEventListener("resize",function(){n.adjust()},{passive:true});e.addEventListener("wheel",function(t){var i=t.deltaY>0?.5:2;var o=t.clientX-e.offsetLeft||e.width/2;var a=t.clientY-e.offsetTop||e.height/2;n.scale(i,o-e.width/2,a-e.height/2)},{passive:true});var t=0,i=0,o=0;e.addEventListener("mousedown",function(e){n.mouseHeld=true;if(n.dragging){n.draggingPositionStart[0]=e.clientX;n.draggingPositionStart[1]=e.clientY;return}t=e.clientX;i=e.clientY;document.body.position="fixed"},{passive:true});e.addEventListener("touchstart",function(t){t.preventDefault();var i=t.touches;if(i.length>1){var n=i[0].clientX-i[1].clientX;var a=i[0].clientY-i[1].clientY;o=Math.sqrt(n*n+a*a)}e.dispatchEvent(new MouseEvent("mousedown",{clientX:i[0].clientX,clientY:i[0].clientY}))});e.addEventListener("touchmove",function(t){t.preventDefault();var i=t.touches;if(i.length===1){e.dispatchEvent(new MouseEvent("mousemove",{clientX:i[0].clientX,clientY:i[0].clientY}))}else if(i.length>1){var a=i[0].clientX-i[1].clientX;var s=i[0].clientY-i[1].clientY;var r=Math.sqrt(a*a+s*s);var l=i[0].clientX+a/2-e.width/2;var c=i[0].clientY+s/2-e.height/2;var u=r/o;n.scale(u,l,c);o=r}});e.addEventListener("touchend",function(t){t.preventDefault();e.dispatchEvent(new MouseEvent("mouseup",{}))});e.addEventListener("touchcancel",function(t){t.preventDefault();e.dispatchEvent(new MouseEvent("mouseup",{}))});e.addEventListener("mousemove",function(o){if(n.dragging){if(o.clientX>e.width*.95){n.translate(1,0);n.draggingPositionStart[0]-=1;n.draggingPositionEnd[0]-=1}else if(o.clientX<e.width*.05){n.translate(-1,0);n.draggingPositionStart[0]+=1;n.draggingPositionEnd[0]+=1}else if(o.clientY>e.height*.95){n.translate(0,1);n.draggingPositionStart[1]-=1;n.draggingPositionEnd[1]-=1}else if(o.clientY<e.height*.05){n.translate(0,-1);n.draggingPositionStart[1]+=1;n.draggingPositionEnd[1]+=1}if(n.mouseHeld){n.draggingPositionEnd[0]=o.clientX;n.draggingPositionEnd[1]=o.clientY}else{n.draggingPositionStart[0]=n.draggingPositionEnd[0]=o.clientX;n.draggingPositionStart[1]=n.draggingPositionEnd[1]=o.clientY}n.shouldRender=true;return}if(!n.mouseHeld){return}n.translate(t-o.clientX,i-o.clientY);document.body.position="absolute";t=o.clientX;i=o.clientY},{passive:true});e.addEventListener("mouseup",function(e){if(n.dragging&&s.openDialog){s.openDialog.emit("drag-end")}},{passive:true});document.body.addEventListener("mouseup",function(){n.mouseHeld=false},{passive:true});r.keyboard.on("keyup",function(e){if(!s.openDialog){var t=e.shiftKey?10:100;if(e.key==="ArrowUp"){n.translate(0,t)}else if(e.key==="ArrowDown"){n.translate(0,-t)}else if(e.key==="ArrowLeft"){n.translate(t,0)}else if(e.key==="ArrowRight"){n.translate(-t,0)}else if(e.key==="+"||e.key==="*"){n.scale(e.shiftKey?1.05:2,0,0)}else if(e.key==="-"||e.key==="_"){n.scale(e.shiftKey?.95:.5,0,0)}else if(e.key==="t"){n.drawHistory=!n.drawHistory;n.shouldRender=true}else if(e.key==="c"){n.drawControls=!n.drawControls;n.shouldRender=true}else if(e.key==="l"){n.drawLabels=!n.drawLabels;n.shouldRender=true}}})}},{"../astrosim.js":7,"../ui/dialogs/dialog-manager.js":23,"../ui/ui.js":36,"./animation.js":1}],4:[function(e,t,i){t.exports=function(){function e(t,i){var n=this;_classCallCheck(this,e);this.running=false;this.started=false;this.stopped=false;this.interval=typeof i==="number"&&i>0?i:null;var o=Date.now();var a=function e(){var i=Date.now();if(n.running){t(i-o)}o=i;if(n.interval){window.setTimeout(e,n.interval)}else{window.requestAnimationFrame(e)}};window.requestAnimationFrame(a)}_createClass(e,[{key:"start",value:function e(){if(this.stopped){return false}this.running=true;this.started=true;return true}},{key:"pause",value:function e(){this.running=false;return true}},{key:"unpause",value:function e(){return!this.stopped&&(this.running=true)}},{key:"togglePause",value:function e(){return this.running?this.pause():this.unpause()}},{key:"stop",value:function e(){this.running=false;this.stopped=true;return true}}]);return e}()},{}],5:[function(e,t,i){var n=e("../content/content.js");var o=e("./animation.js");var a=e("../content/body.js");var s=e("../ui/ui.js");var r=e("../content/vec2.js");o.drawCircle=function(e,t,i,n){var o=this.canvas,a=this.ctx;if(e-i>o.width||e+i<0||t-i>o.height||t+i<0){return}a.fillStyle=n;a.beginPath();a.moveTo(e,t-i);a.arc(e,t,i,0,Math.PI*2,true);a.fill()};o.renderControls=function(){var e=this.translation,t=this.ratio;var i=this.textCanvas;var a=this.textCtx;a.clearRect(0,0,i.width,i.height);if(!o.drawControls){return}a.fillStyle="#FFFFFF";var s=200;var r=(s*n.METERS_PER_PIXEL/this.ratio).toExponential(2);a.fillRect(i.width-s-20,i.height-22,s,2);a.textAlign="center";a.fillText(r+"m",i.width-s/2-20,i.height-40);a.textAlign="right";a.fillText("Simulated time: "+n.simulatedTime.toExponential(1)+"s",i.width-20,20);a.fillText("Real time: "+Math.round(n.realTime).toString()+"s",i.width-20,40);a.fillText("Ticks: "+n.ticks.toExponential(1),i.width-20,60);var l=Math.round(o.frames/3/n.realTime);a.fillText("FPS: "+(isNaN(l)?0:l),i.width-20,80);if(o.dragging){a.fillStyle="#000000";a.fillRect(i.width/2-100,84,200,22);a.fillStyle="#FFFFFF";a.textAlign="center";a.fillText("Click to select a position or hit X to return.",i.width/2,100)}};o.render=function(){var e=this.ctx,t=this.canvas,i=this.translation;var a=n.objects;e.clearRect(0,0,t.width,t.height);if(s.selectedObjects.length>0){this.center(r.scale(r.center(s.selectedObjects.map(function(e){return e.position}),n.temp1),1/n.METERS_PER_PIXEL,n.temp1))}if(a.length>0){var l=n.temp1;l[0]=t.width/2;l[1]=t.height/2;var c=n.temp2;var u=this.translation[0]+l[0];var d=this.translation[1]+l[1];var v=this.ratio/n.METERS_PER_PIXEL;var h=void 0;for(h in a){var m=a[h];r.scale(m.position,v,c);c[0]+=u;c[1]+=d;var g=m.radius*this.ratio/n.METERS_PER_PIXEL;var f=m.color.hexString();this.drawCircle(c[0],c[1],Math.max(g,3),f);if(o.drawLabels){e.textAlign="left";e.fillText(m.name,c[0]+g+3,c[1])}if(o.drawHistory){e.beginPath();e.strokeStyle=f;var p=void 0;var y=m.history;if(m.historyOverflow){var b=y.length;e.moveTo(y[m.historyIndex]*v+u,y[m.historyIndex+1]*v+d);for(p=m.historyIndex+2;p<b;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}for(p=0;p<m.historyIndex;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}}else{e.moveTo(y[0]*v+u,y[1]*v+d);for(p=2;p<m.historyIndex;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}}e.lineTo(c[0],c[1]);e.stroke()}}}if(o.dragging){if(o.draggingCenter){var j=_slicedToArray(o.draggingPositionEnd,2),E=j[0],w=j[1];e.strokeStyle=o.draggingColor;e.beginPath();e.moveTo(E,w-10);e.lineTo(E,w+10);e.moveTo(E-10,w);e.lineTo(E+10,w);e.stroke()}else{var k=o.draggingPositionStart;var x=o.draggingRadius*this.ratio/n.METERS_PER_PIXEL;var C=o.draggingColor;this.drawCircle(k[0],k[1],Math.max(x,3),C);if(o.mouseHeld){var _=o.draggingPositionEnd;e.strokeStyle="#FFFFFF";e.beginPath();e.moveTo(k[0],k[1]);e.lineTo(_[0],_[1]);e.stroke()}}}if(o.drawControls){var I=i[0]+t.width/2;var L=i[1]+t.height/2;e.strokeStyle="#FFFFFF";e.beginPath();e.moveTo(I,L-10);e.lineTo(I,L+10);e.moveTo(I-10,L);e.lineTo(I+10,L);e.stroke();return}}},{"../content/body.js":8,"../content/content.js":9,"../content/vec2.js":12,"../ui/ui.js":36,"./animation.js":1}],6:[function(e,t,i){var n=e("./animation.js");var o=e("../content/vec2.js");n.center=function(e){o.scale(e,-this.ratio,this.translation)};n.translate=function(e,t){n.translation[0]-=e;n.translation[1]-=t;n.shouldRender=true};n.scale=function(e,t,i){var o=n.ratio*e;if(o<n.MIN_SCALING){return}if(o>n.MAX_SCALING){return}n.ratio=o;var a=((t||0)-n.translation[0])/n.width;var s=((i||0)-n.translation[1])/n.height;n.width=canvas.width*o;n.height=canvas.height*o;var r=n.width*a-t;var l=n.height*s-i;n.translation[0]=-r;n.translation[1]=-l;n.shouldRender=true}},{"../content/vec2.js":12,"./animation.js":1}],7:[function(e,t,i){var n=e("./animation/loop.js");var o=t.exports={mainLoop:new n(function(e){o.content.update(e)})};document.addEventListener("DOMContentLoaded",function(){o.animation=e("./animation/animation.js");o.content=e("./content/content.js");o.ui=e("./ui/ui.js");o.animation.initialize();o.content.initialize();o.ui.initialize();o.mainLoop.start()},{passive:true})},{"./animation/animation.js":1,"./animation/loop.js":4,"./content/content.js":9,"./ui/ui.js":36}],8:[function(e,t,i){var n=e("../animation/color.js");var o=e("./content.js");var a=e("./vec2.js");t.exports=function(){function e(t,i,o,s){_classCallCheck(this,e);this.position=t;this.velocity=a.create();this.mass=i||0;this.radius=o;this.color=new n;this.name=s;this.history=new Float32Array(200);this.historyIndex=0;this.historyOverflow=false;this.history[0]=t[0];this.history[1]=t[1]}_createClass(e,[{key:"applyForce",value:function e(t){var i=1/this.mass;this.velocity[0]+=t[0]*i;this.velocity[1]+=t[1]*i}},{key:"serialize",value:function e(){return{positionX:this.position[0],positionY:this.position[1],velocityX:this.velocity[0],velocityY:this.velocity[1],mass:this.mass,radius:this.radius,color:this.color.hexString(),name:this.name}}},{key:"move",value:function e(t){this.position[0]+=this.velocity[0]*t;this.position[1]+=this.velocity[1]*t}},{key:"savePosition",value:function e(){this.history[this.historyIndex]=this.position[0];this.history[this.historyIndex+1]=this.position[1];this.historyIndex+=2;if(this.historyIndex>=this.history.length){this.historyIndex=0;this.historyOverflow=true}}},{key:"clearHistory",value:function e(){this.historyIndex=0;this.historyOverflow=false}},{key:"update",value:function e(t){var i=o.objects;var n=void 0;for(n in i){var a=i[n];if(a===this||a.id===this.id){continue}this.interact(a,i,n,t)}}},{key:"interact",value:function t(i,n,s,r){var l=a.subtract(this.position,i.position,o.temp1);var c=a.getLength(l)||1e-10;if(isNaN(l[0])||isNaN(l[1])){l[0]=l[1]=0}if(c<this.radius){var u=a.weighedCenter(this.position,this.mass,i.position,i.mass,l);var d=Math.sqrt(this.radius*this.radius+i.radius*i.radius);var v=new e(a.copy(u),this.mass+i.mass,d);o.remove(i);o.remove(this);var h=a.scale(this.velocity,this.mass,o.temp2);var m=a.scale(i.velocity,i.mass,o.temp3);a.add(h,m,v.velocity);a.scale(v.velocity,1/v.mass,v.velocity);v.color=this.color.interpolate(i.color);o.add(v)}else{var g=o.temp2;a.scale(a.normalize(l,o.temp3),-r*o.GRAVITY_CONSTANT*(this.mass*i.mass)/(c*c),g);this.applyForce(g);o.save(this.id,i.id,a.getLength(g),a.getLength(l))}}}],[{key:"fromSerialized",value:function t(i){if(!i){return null}var o=new e(a.create(typeof i.positionX==="number"?i.positionX:0,typeof i.positionY==="number"?i.positionY:0),typeof i.mass==="number"?i.mass:1e3,typeof i.radius==="number"?i.radius:1e3,typeof i.name==="string"?i.name:"Object");o.color=n.fromHexString(i.color);o.velocity[0]=typeof i.velocityX==="number"?i.velocityX:0;o.velocity[1]=typeof i.velocityY==="number"?i.velocityY:0;return o}}]);return e}()},{"../animation/color.js":2,"./content.js":9,"./vec2.js":12}],9:[function(e,t,i){var n=e("../animation/animation.js");var o=e("../astrosim.js");var a=e("./history.js");var s=e("./vec2.js");var r=t.exports=o.content={editedObject:null,objects:[],currentId:0,METERS_PER_PIXEL:3e8,GRAVITY_CONSTANT:6.67408e-11,toBeDeleted:[],ticks:0,realTime:0,simulatedTime:0,pendingTicks:0,TICKS_PER_FRAME:10,SECONDS_IN_YEAR:31556927,TIME_FACTOR:1,temp1:s.create(),temp2:s.create(),temp3:s.create(),histories:[],initialize:function e(){this.TIME_FACTOR=this.SECONDS_IN_YEAR/12},add:function e(){var t=this.objects;var i=void 0;for(i in arguments){var n=arguments[i];n.id=t.push(n)-1;this.addHistory(n.id)}o.ui.update()},addHistory:function e(t){var i=this.histories;var n=i.length;i[t]=[];var o=void 0;for(o=0;o<n;o+=1){if(o!==t){var s=new a;var r=new a;var l={force:s,distance:r};i[o][t]=l;i[t][o]=l}}},save:function e(t,i,n,o){if(this.histories[t]&&this.histories[t][i]){this.histories[t][i].force.add(n);this.histories[t][i].distance.add(o)}},remove:function e(t){this.objects.splice(t.id,1);this.toBeDeleted.push(t.id)},commitRemove:function e(){var t=this.histories,i=this.toBeDeleted;var n=void 0;for(n in i){var o=i[n];var a=void 0;for(a in t){if(a!==o){t[a].splice(o,1)}}t.splice(o,1)}this.toBeDeleted=[]},update:function e(t){var i=this.objects;if(this.pendingTicks>100){this.TICKS_PER_FRAME-=1}this.pendingTicks+=this.TICKS_PER_FRAME;var o=t<1e3?t:1e3;var a=o/1e3*this.TIME_FACTOR/this.TICKS_PER_FRAME;this.realTime+=o/1e3;this.simulatedTime+=a;var s=void 0;while(this.pendingTicks>0){this.ticks+=1;for(s in i){i[s].update(a)}for(s in i){i[s].move(a);if(this.ticks%n.traceFrequency===0){i[s].savePosition()}}if(this.toBeDeleted.length>0){this.commitRemove()}this.pendingTicks-=1}},momentum:function e(){return this.objects.reduce(function(e,t){return s.add(e,s.scale(t.velocity,t.mass))},s.create())},velocity:function e(){return s.scale(this.momentum(),1/this.objects.reduce(function(e,t){return e+t.mass},0))}}},{"../animation/animation.js":1,"../astrosim.js":7,"./history.js":11,"./vec2.js":12}],10:[function(e,t,i){t.exports=function(){function e(){_classCallCheck(this,e);this._events=[]}_createClass(e,[{key:"on",value:function e(t,i){var n=this._events;if(Array.isArray(n[t])){n[t].push(i)}else{n[t]=[i]}return this}},{key:"once",value:function e(t,i){var n=this._events;var o=function e(){i.apply(self,Array.prototype.slice.call(arguments));n[t].splice([n[t].indexOf(e)],1)};if(Array.isArray(n[t])){n[t].push(o)}else{n[t]=[o]}return this}},{key:"emit",value:function e(t){var i=this._events;var n=Array.prototype.slice.call(arguments,1);if(Array.isArray(i[t])){i[t].forEach(function(e){e.apply(self,n)})}}}]);return e}()},{}],11:[function(e,t,i){var n=t.exports=function(){function e(){_classCallCheck(this,e);this.average=0;this.min=0;this.max=0;this.count=0}_createClass(e,[{key:"add",value:function e(t){if(t<this.min||this.count===0){this.min=t}if(t>this.max||this.count===0){this.max=t}this.average=(this.average*this.count+t)/(this.count+=1)}}]);return e}()},{}],12:[function(e,t,i){t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"create",value:function e(t,i){var n=new Float32Array(2);n[0]=t||0;n[1]=i||0;return n}},{key:"copy",value:function t(i,n){var o=n;if(!o){o=e.create(i[0],i[1])}else{o[0]=i[0];o[1]=i[1]}return o}},{key:"weighedCenter",value:function t(i,n,o,a,s){var r=s;if(!r){r=e.create()}var l=a/(n+a);r[0]=l*(o[0]-i[0]||1e-10)+i[0];r[1]=l*(o[1]-i[1]||1e-10)+i[1];return r}},{key:"center",value:function t(i,n){var o=n;if(!o){o=e.create()}var a=void 0,s=0,r=0,l=0;for(a in i){s=(s*l+i[a][0])/(l+1);r=(r*l+i[a][1])/(l+1);l+=1}o[0]=s;o[1]=r;return o}},{key:"add",value:function t(i,n,o){var a=o;if(!a){a=e.create()}a[0]=i[0]+n[0];a[1]=i[1]+n[1];return a}},{key:"subtract",value:function t(i,n,o){var a=o;if(!a){a=e.create()}a[0]=i[0]-n[0];a[1]=i[1]-n[1];return a}},{key:"getLength",value:function e(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}},{key:"getAngle",value:function e(t){if(t[0]===0){return t[1]>0?Math.PI/2:-Math.PI/2}return Math.atan(t[1]/t[0])}},{key:"rotate",value:function t(i,n,o){var a=o;if(!a){a=e.create()}var s=Math.sin(n);var r=Math.cos(n);a[0]=i[0]*r-i[1]*s;a[1]=i[0]*s+i[1]*r;return a}},{key:"normalize",value:function t(i,n){var o=n;if(!o){o=e.create()}var a=e.getLength(i);o[0]=i[0]/a;o[1]=i[1]/a;return o}},{key:"scale",value:function t(i,n,o){var a=o;if(!a){a=e.create()}a[0]=i[0]*n;a[1]=i[1]*n;return a}}]);return e}()},{}],13:[function(e,t,i){t.exports={meta:{name:"Earth and Moon",description:"Shows the moon orbiting the earth."},viewport:{translationX:0,translationY:0,ratio:250},content:{selectedObjectIndices:[],timeFactor:1e5,objects:[{name:"Earth",positionX:0,positionY:0,velocityX:0,velocityY:-12.58,mass:5.974e24,radius:6367467.5,color:"#0000ff"},{name:"Moon",positionX:3844e5,positionY:0,velocityX:0,velocityY:1023,mass:7.349e22,radius:1738e3,color:"#888888"}]}}},{}],14:[function(e,t,i){t.exports={meta:{name:"Empty Scene",description:"Empty Scene."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[]}}},{}],15:[function(e,t,i){t.exports=[e("./earth-moon.json"),e("./empty.json"),e("./solar-system.json"),e("./sun-earth.json"),e("./trappist-1.json")]},{"./earth-moon.json":13,"./empty.json":14,"./solar-system.json":16,"./sun-earth.json":17,"./trappist-1.json":18}],16:[function(e,t,i){t.exports={meta:{name:"Solar System",description:"A scene containing the sun and our planets (including Pluto)."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[{name:"Sun",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.9884e30,radius:14e8,color:"#ffff00"},{name:"Mercury",positionX:57909e6,positionY:0,velocityX:0,velocityY:47360,mass:3.301e23,radius:244e4,color:"#bb8800"},{name:"Venus",positionX:0,positionY:10816e7,velocityX:-35020,velocityY:0,mass:4.869e24,radius:6051800,color:"#dddd44"},{name:"Earth",positionX:-1496e8,positionY:0,velocityX:0,velocityY:-29780,mass:5.974e24,radius:6367467.5,color:"#0000ff"},{name:"Moon",positionX:-1492156e5,positionY:0,velocityX:0,velocityY:-30803,mass:7.349e22,radius:1738e3,color:"#888888"},{name:"Mars",positionX:0,positionY:-22799e7,velocityX:24130,velocityY:0,mass:6.419e23,radius:3386200,color:"#ff0000"},{name:"Jupiter",positionX:77836e7,positionY:0,velocityX:0,velocityY:13070,mass:1.899e27,radius:69173e3,color:"#bbaa88"},{name:"Saturn",positionX:0,positionY:14335e8,velocityX:-9690,velocityY:0,mass:5.685e26,radius:57316e3,color:"#ffaa00"},{name:"Uranus",positionX:-28724e8,positionY:0,velocityX:0,velocityY:-6810,mass:8.683e25,radius:25266e3,color:"#dddfff"},{name:"Neptune",positionX:0,positionY:-44984e8,velocityX:5430,velocityY:0,mass:1.0243e26,radius:24552500,color:"#00045b"},{name:"Pluto",positionX:59064e8,positionY:0,velocityX:0,velocityY:4670,mass:1.303e22,radius:2374,color:"#777733"}]}}},{}],17:[function(e,t,i){t.exports={meta:{name:"Sun and Earth",description:""},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[{name:"Sun",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.9884e30,radius:14e8,color:"#ffff00"},{name:"Earth",positionX:148999995392,positionY:0,velocityX:0,velocityY:29780,mass:5.974e24,radius:6e6,color:"#0000ff"}]}}},{}],18:[function(e,t,i){t.exports={meta:{name:"TRAPPIST-1",description:"The 2MASS J23062928-0502285 system (also known as TRAPPIST-1A). Note that Trappist-1h's mass is unknown."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e4,objects:[{name:"Trappist-1",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.6309144e29,radius:81472014,color:"#ffb257"},{name:"Trappist-1b",positionX:165539e4,positionY:0,velocityX:0,velocityY:79998.97961860064,mass:5.07637e24,radius:6918906,color:"#f9882a"},{name:"Trappist-1c",positionX:0,positionY:226778e4,velocityX:-68370.68304792153,velocityY:0,mass:8.241636e24,radius:6727776,color:"#d38c43"},{name:"Trappist-1d",positionX:-3129e6,positionY:0,velocityX:0,velocityY:-56416.19787734072,mass:2.448602e24,radius:4918412,color:"#ab8359"},{name:"Trappist-1e",positionX:0,positionY:-4172e6,velocityX:49940.55069291154,velocityY:0,mass:3.702764e24,radius:5848578,color:"#aa8677"},{name:"Trappist-1f",positionX:5513e6,positionY:0,velocityX:0,velocityY:43721.587579426,mass:4.061096e24,radius:6657695,color:"#846a63"},{name:"Trappist-1g",positionX:0,positionY:6705e6,velocityX:-39631.44443220881,velocityY:0,mass:8.002748e24,radius:7180117,color:"#a39d6a"},{name:"Trappist-1h",positionX:-9387e6,positionY:0,velocityX:0,velocityY:-34269.539862908656,mass:1,radius:4810105,color:"#ddae83"}]}}},{}],19:[function(e,t,i){var n=e("../animation/animation.js");var o=e("../content/body.js");var a=e("../content/content.js");var s=e("../ui/ui.js");var r=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"selectScene",value:function e(t){a.objects=[];a.histories=[];a.currentId=a.realTime=a.simulatedTime=a.ticks=a.pendingTicks=0;a.add.apply(a,t.content.objects.map(function(e){return o.fromSerialized(e)}));a.TIME_FACTOR=t.content.timeFactor;n.frames=0;n.translation[0]=t.viewport.translationX;n.translation[1]=t.viewport.translationY;n.ratio=t.viewport.ratio;n.width=n.canvas.width*n.ratio;n.height=n.canvas.height*n.ratio;s.selectedObjects=t.content.selectedObjectIndices.map(function(e){return a.objects[e]});n.shouldRender=true;s.pause()}},{key:"validateData",value:function e(t){return(typeof t==="undefined"?"undefined":_typeof(t))==="object"&&_typeof(t.meta)==="object"&&typeof t.meta.name==="string"&&typeof t.meta.description==="string"&&_typeof(t.viewport)==="object"&&typeof t.viewport.translationX==="number"&&!isNaN(t.viewport.translationX)&&typeof t.viewport.translationY==="number"&&!isNaN(t.viewport.translationY)&&typeof t.viewport.ratio==="number"&&!isNaN(t.viewport.ratio)&&t.viewport.ratio>0&&_typeof(t.content)==="object"&&typeof t.content.timeFactor==="number"&&Array.isArray(t.content.objects)&&Array.isArray(t.content.selectedObjectIndices)&&t.content.selectedObjectIndices.every(function(e){return e>-1&&e<t.content.selectedObjectIndices.length})&&t.content.objects.filter(function(e){return(typeof e==="undefined"?"undefined":_typeof(e))==="object"&&typeof e.name==="string"&&typeof e.positionX==="number"&&typeof e.positionY==="number"&&typeof e.velocityX==="number"&&typeof e.velocityY==="number"&&typeof e.mass==="number"&&e.mass>0&&typeof e.radius==="number"&&e.radius>0&&typeof e.color==="string"&&r.test(e.color)})}}]);return e}()},{"../animation/animation.js":1,"../content/body.js":8,"../content/content.js":9,"../ui/ui.js":36}],20:[function(e,t,i){var n=e("../animation/animation.js");var o=e("../content/content.js");var a=e("../ui/ui.js");t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"createData",value:function e(){var t={};t.meta={name:"AstroSim scene",description:"Your own AstroSim scene."};t.viewport={translationX:n.translation[0],translationY:n.translation[1],ratio:n.ratio};t.content={selectedObjectIndices:a.selectedObjects.map(function(e){return o.objects.indexOf(e)}).sort(),objects:o.objects.map(function(e){return e.serialize()}),timeFactor:o.TIME_FACTOR};return t}},{key:"serialize",value:function e(t){var i=document.createElement("a");var n=new Blob([JSON.stringify(t,null,"  ")],{type:"application/json"});i.href=URL.createObjectURL(n);i.download="astro-scene.json";document.body.appendChild(i);i.click();document.body.removeChild(i)}}]);return e}()},{"../animation/animation.js":1,"../content/content.js":9,"../ui/ui.js":36}],21:[function(e,t,i){var n=e("./dialog.js");var o=t.exports=new n(document.getElementById("about-dialog"));var a=document.getElementById("about-submit");o.on("open",a.focus.bind(a));a.addEventListener("click",function(){o.close()})},{"./dialog.js":24}],22:[function(e,t,i){var n=e("./dialog.js");var o=t.exports=new n(document.getElementById("details-dialog"));document.getElementById("details-submit").addEventListener("click",function(){o.close()})},{"./dialog.js":24}],23:[function(e,t,i){t.exports={aboutDialog:null,detailsDialog:null,settingsDialog:null,objectDialog:null,newObjectDialog:null,sceneDialog:null,openDialog:null,initialize:function t(){this.aboutDialog=e("./about-dialog.js");this.detailsDialog=e("./details-dialog.js");this.settingsDialog=e("./settings-dialog.js");this.objectDialog=e("./object-dialog.js");this.newObjectDialog=e("./new-object-dialog.js");this.sceneDialog=e("./scene-dialog.js")}}},{"./about-dialog.js":21,"./details-dialog.js":22,"./new-object-dialog.js":28,"./object-dialog.js":29,"./scene-dialog.js":30,"./settings-dialog.js":31}],24:[function(e,t,i){var n=e("../../animation/animation.js");var o=e("./dialog-manager.js");var a=e("../../content/event-emitter.js");var s=e("../../ui/ui.js");t.exports=function(e){_inherits(t,e);function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i.element=e;e.classList.add("dialog-closed");e.classList.add("dialog");i.opened=false;i.inputs={};i.invalidInputs={};i.valid=true;return i}_createClass(t,[{key:"registerInput",value:function e(){var t=void 0;for(t in arguments){var i=arguments[t];this.inputs[i.name]=i}}},{key:"set",value:function e(t){var i=void 0;var n=this.inputs;for(i in n){var o=n[i];if(t[i]){o.value=t[i]}}}},{key:"validate",value:function e(){var t=true;var i=this.invalidInputs=[];var n=true;var o=void 0;var a=this.inputs;for(o in a){var s=a[o];if(typeof s.checkValidity==="function"){n=s.checkValidity()}else{var r=s.filterFunction||this.defaultFilterFunction;n=!!r(s,s.value,o);if(!n){i.push(s);s.classList.add("dialog-input-invalid")}else{s.classList.remove("dialog-input-invalid")}}t=t&&n}return t}},{key:"getInputByName",value:function e(t){return this.inputs[t]||null}},{key:"setFilterFunction",value:function e(t,i){t.filterFunction=i}},{key:"defaultFilterFunction",value:function e(){return true}},{key:"open",value:function e(){if(o.openDialog){return}this.element.classList.add("dialog-open");this.element.classList.remove("dialog-closed");this.opened=true;o.openDialog=this;n.pause();this.emit("open")}},{key:"show",value:function e(){this.element.classList.add("dialog-open");this.element.classList.remove("dialog-closed")}},{key:"hide",value:function e(){this.element.classList.remove("dialog-open");this.element.classList.add("dialog-closed")}},{key:"close",value:function e(){this.element.classList.remove("dialog-open");this.element.classList.add("dialog-closed");this.opened=false;o.openDialog=null;document.activeElement.blur();this.emit("close");if(s.isPlaying){n.unpause()}}},{key:"submit",value:function e(){if(this.validate()){this.emit("submit");this.close()}}}],[{key:"greaterThanZero",value:function e(t,i){var n=Number(i);return n>0}}]);return t}(a)},{"../../animation/animation.js":1,"../../content/event-emitter.js":10,"../../ui/ui.js":36,"./dialog-manager.js":23}],25:[function(e,t,i){var n=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,i,n){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,"m",1,"meter"));o.addUnit("AU",149597870700,"astronomical unit");o.addUnit("ly",94607e11,"light year");o.addUnit("pc",30857e12,"parsec");return o}return t}(n)},{"./multi-unit-input.js":27}],26:[function(e,t,i){var n=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,i,n){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,"kg",1,"kilogram"));o.addUnit("solar mass",1.98855e30,"proportion of solar mass");o.buttons["solar mass"].innerHTML='M<span class="sub">â˜‰</span>';return o}_createClass(t,[{key:"checkValidity",value:function e(){var t=this.value>0;if(t){this._inputElement.classList.remove("dialog-input-invalid")}else{this._inputElement.classList.add("dialog-input-invalid")}return t}}]);return t}(n)},{"./multi-unit-input.js":27}],27:[function(e,t,i){t.exports=function(){function e(t,i,n,o,a,s){_classCallCheck(this,e);this.units={};this.buttons={};this._unit=o;this.wrapperElement=t
;var r=this._inputElement=document.createElement("input");this.name=r.name=i;t.appendChild(r);this.addUnit(o,a,s);this.value=n;this.setUnit(o)}_createClass(e,[{key:"addUnit",value:function e(t,i,n){this.units[t]=i;var o=document.createElement("button");o.textContent=t;o.classList.add("unit-push-button");o.addEventListener("click",this.setUnit.bind(this,t));o.setAttribute("tabindex","-1");if(n){o.title=n}this.buttons[t]=o;this.wrapperElement.appendChild(o)}},{key:"checkValidity",value:function e(){return true}},{key:"setUnit",value:function e(t){var i=this.units[t];var n=this.value;this.buttons[this._unit].classList.remove("pushed");this._unit=t;this.buttons[t].classList.add("pushed");this.value=n}},{key:"value",get:function e(){return Number(this._inputElement.value)*this.units[this._unit]},set:function e(t){this._inputElement.value=(t/this.units[this._unit]).toExponential(3)}}]);return e}()},{}],28:[function(e,t,i){var n=e("../../animation/animation.js");var o=e("./dialog.js");var a=e("../../content/vec2.js");var s=e("./length-input.js");var r=e("./unsigned-length-input.js");var l=e("./mass-input");var c=e("./velocity-input.js");var u=e("../../animation/color.js");var d=e("../../content/body.js");var v=e("../../content/content.js");var h=t.exports=new o(document.getElementById("new-object-dialog"));var m=document.getElementById("new-object-name");var g=new s(document.getElementById("new-object-position-x"),"position-x",0);var f=new s(document.getElementById("new-object-position-y"),"position-y",0);var p=new c(document.getElementById("new-object-velocity-x"),"velocity-x",0);var y=new c(document.getElementById("new-object-velocity-y"),"velocity-y",0);var b=new l(document.getElementById("new-object-mass"),"mass",0);var j=new r(document.getElementById("new-object-radius"),"radius",0);var E=document.getElementById("new-object-color");h.registerInput(m,g,f,p,y,b,j);h.on("drag-end",function(){g.value=(n.draggingPositionStart[0]-n.translation[0]-n.canvas.width/2)*v.METERS_PER_PIXEL/n.ratio;f.value=(n.draggingPositionStart[1]-n.translation[1]-n.canvas.height/2)*v.METERS_PER_PIXEL/n.ratio;p.value=(n.draggingPositionEnd[0]-n.draggingPositionStart[0])/n.ratio;y.value=(n.draggingPositionEnd[1]-n.draggingPositionStart[1])/n.ratio;n.dragging=false;h.show()});document.getElementById("new-object-drag-position").addEventListener("click",function(){if(!j.checkValidity()){j._inputElement.focus();return}n.dragging=true;n.draggingRadius=j.value;n.draggingColor=E.value;h.hide()});document.getElementById("new-object-position-center").addEventListener("click",function(){g.value=-n.translation[0]*v.METERS_PER_PIXEL/n.ratio;f.value=-n.translation[1]*v.METERS_PER_PIXEL/n.ratio});document.getElementById("new-object-submit").addEventListener("click",h.submit=function(){if(h.validate()){var e=a.create(Number(g.value),Number(f.value));var t=a.create(Number(p.value),Number(y.value));var i=new d(e,Number(b.value),Number(j.value),m.value.toString());i.velocity=t;i.color=u.fromHexString(E.value);v.add(i);h.close();n.shouldRender=true}})},{"../../animation/animation.js":1,"../../animation/color.js":2,"../../content/body.js":8,"../../content/content.js":9,"../../content/vec2.js":12,"./dialog.js":24,"./length-input.js":25,"./mass-input":26,"./unsigned-length-input.js":32,"./velocity-input.js":33}],29:[function(e,t,i){var n=e("../../animation/animation.js");var o=e("../../content/content.js");var a=e("./length-input.js");var s=e("./unsigned-length-input.js");var r=e("./mass-input");var l=e("./velocity-input.js");var c=e("../../animation/color.js");var u=e("./dialog.js");var d=e("../../ui/ui.js");var v=t.exports=new u(document.getElementById("object-dialog"));var h=document.getElementById("object-name");var m=new a(document.getElementById("object-position-x"),"position-x",0);var g=new a(document.getElementById("object-position-y"),"position-y",0);var f=new l(document.getElementById("object-velocity-x"),"velocity-x",0);var p=new l(document.getElementById("object-velocity-y"),"velocity-y",0);var y=new r(document.getElementById("object-mass"),"mass",0);var b=new s(document.getElementById("object-radius"),"radius",0);var j=document.getElementById("object-color");v.registerInput(h,m,g,f,p,y,b);v.on("drag-end",function(){m.value=(n.draggingPositionStart[0]-n.translation[0]-n.canvas.width/2)*o.METERS_PER_PIXEL/n.ratio;g.value=(n.draggingPositionStart[1]-n.translation[1]-n.canvas.height/2)*o.METERS_PER_PIXEL/n.ratio;f.value=(n.draggingPositionEnd[0]-n.draggingPositionStart[0])/n.ratio;p.value=(n.draggingPositionEnd[1]-n.draggingPositionStart[1])/n.ratio;n.dragging=false;v.show()});document.getElementById("object-drag-position").addEventListener("click",function(){if(!b.checkValidity()){b._inputElement.focus();return}n.dragging=true;n.draggingRadius=b.value;n.draggingColor=j.value;v.hide()});document.getElementById("object-position-center").addEventListener("click",function(){m.value=(-n.translation[0]*o.METERS_PER_PIXEL/n.ratio).toExponential(3);g.value=(-n.translation[1]*o.METERS_PER_PIXEL/n.ratio).toExponential(3)});v.setValues=function(){var e=o.editedObject;j.value=e.color.hexString();v.set({name:e.name||"Object #"+e.id,"position-x":e.position[0].toExponential(3),"position-y":e.position[1].toExponential(3),"velocity-x":e.velocity[0].toExponential(3),"velocity-y":e.velocity[1].toExponential(3),mass:e.mass.toExponential(3),radius:e.radius.toExponential(3)})};document.getElementById("object-submit").addEventListener("click",v.submit=function(){if(v.validate()){var e=o.editedObject;e.name=h.value;e.position[0]=Number(m.value);e.position[1]=Number(g.value);e.velocity[0]=Number(f.value);e.velocity[1]=Number(p.value);e.mass=Number(y.value);e.radius=Number(b.value);e.color=c.fromHexString(j.value);e.clearHistory();v.close();d.update();n.shouldRender=true}})},{"../../animation/animation.js":1,"../../animation/color.js":2,"../../content/content.js":9,"../../ui/ui.js":36,"./dialog.js":24,"./length-input.js":25,"./mass-input":26,"./unsigned-length-input.js":32,"./velocity-input.js":33}],30:[function(e,t,i){var n=e("../../serialization/deserializer.js");var o=e("./dialog.js");var a=e("../../scenes/list.js");var s=t.exports=new o(document.getElementById("scene-dialog"));var r=document.getElementById("drop-area");var l=document.getElementById("deserialize-file");var c=document.getElementById("scene-name");var u=document.getElementById("scene-description");var d=new FileReader;var v=document.getElementById("deserialize-select");var h=document.getElementById("deserialize-default");var m=document.getElementById("deserialize-file-item");var g=document.getElementById("invalid-scene");var f=document.getElementById("invalid-scene-message");var p=/^.*\.json$/;var y=null;l.value="";s.showError=function(e){f.textContent="Could not load the selected scene: "+e;g.classList.remove("hidden")};s.hideError=function(e){g.classList.add("hidden")};a.forEach(function(e){var t=document.createElement("option");t.value=e.meta.name;t.textContent=e.meta.name;h.appendChild(t)});l.addEventListener("change",function(){m.classList.remove("hidden");d.onload=function(){b(d.result)};if(l.files[0]){d.readAsText(l.files[0])}});v.addEventListener("change",function(){if(v.selectedIndex===0){m.classList.remove("hidden");d.onload=function(){b(d.result)};if(l.files[0]){d.readAsText(l.files[0])}}else{m.classList.add("hidden");var e=a[v.selectedIndex-1];c.textContent=e.meta.name||sceneNames[v.selectedIndex-1];u.textContent=e.meta.description||c.textContent;s.hideError();y=e}});r.addEventListener("drop",function(e){e.stopPropagation();e.preventDefault();var t=Array.from(e.dataTransfer.files);var i=void 0;for(i in t){var n=t[i];if(n.type==="text/json"||p.test(n.name)){d.readAsText(n);d.onload=function(){b(d.result)};return}}});r.addEventListener("dragover",function(e){e.preventDefault()});r.addEventListener("dragend",function(e){var t=e.dataTransfer;if(t.items){var i=t.items;var n=void 0;for(n in i){var o=i[n];i.remove(n)}}else{e.dataTransfer.clearData()}});var b=function e(t){var i=void 0;try{i=JSON.parse(t)}catch(e){s.showError("Error parsing the selected file: "+e.message);y=null;return}if(n.validateData(i)){y=i;c.textContent=i.meta.name||"User defined scene";u.textContent=i.meta.description||c.textContent;s.hideError()}else{y=null;s.showError("Error: Invalid scene.")}};document.getElementById("load-scene").addEventListener("click",s.submit=function(){if(y){n.selectScene(y);s.close();s.hideError()}})},{"../../scenes/list.js":15,"../../serialization/deserializer.js":19,"./dialog.js":24}],31:[function(e,t,i){var n=e("../../animation/animation.js");var o=e("../../content/content.js");var a=e("./dialog.js");var s=e("../../ui/ui.js");var r=t.exports=new a(document.getElementById("settings-dialog"));var l=document.getElementById("settings-translation-x");var c=document.getElementById("settings-translation-y");var u=document.getElementById("settings-scaling-factor");var d=document.getElementById("settings-draw-history");var v=document.getElementById("settings-draw-controls");var h=document.getElementById("settings-draw-labels");var m=document.getElementById("settings-time-factor");d.checked=true;v.checked=true;h.checked=false;r.registerInput(l,c,u,m);r.setFilterFunction(u,a.greaterThanZero);r.setFilterFunction(m,a.greaterThanZero);r.on("drag-end",function(){l.value=(n.translation[0]+n.draggingPositionEnd[0]-n.canvas.width/2).toExponential(3);c.value=(n.translation[1]+n.draggingPositionEnd[1]-n.canvas.height/2).toExponential(3);n.dragging=false;n.draggingCenter=false;n.shouldRender=true;r.show()});document.getElementById("settings-drag-center").addEventListener("click",function(){n.dragging=true;n.draggingColor="#3477CC";n.draggingCenter=true;r.hide()});r.setValues=function(){d.checked=n.drawHistory;v.checked=n.drawControls;h.checked=n.drawLabels;r.set({"translation-x":n.translation[0].toExponential(3),"translation-y":n.translation[1].toExponential(3),"scaling-factor":n.ratio.toExponential(3),"time-factor":o.TIME_FACTOR.toExponential(3)})};document.getElementById("center-viewport").addEventListener("click",function(){n.translation[0]=l.value=0;n.translation[1]=c.value=0;s.selectedObject=null});document.getElementById("settings-submit").addEventListener("click",r.submit=function(){if(r.validate()){n.translation[0]=Number(l.value);n.translation[1]=Number(c.value);n.ratio=Number(u.value);n.drawHistory=d.checked;n.drawControls=v.checked;n.drawLabels=h.checked;r.close();o.TIME_FACTOR=Number(m.value);n.shouldRender=true}})},{"../../animation/animation.js":1,"../../content/content.js":9,"../../ui/ui.js":36,"./dialog.js":24}],32:[function(e,t,i){var n=e("./length-input.js");t.exports=function(e){_inherits(t,e);function t(e,i,n){_classCallCheck(this,t);return _possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n))}_createClass(t,[{key:"checkValidity",value:function e(){var t=this.value>0;if(t){this._inputElement.classList.remove("dialog-input-invalid")}else{this._inputElement.classList.add("dialog-input-invalid")}return t}}]);return t}(n)},{"./length-input.js":25}],33:[function(e,t,i){var n=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,i,n){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,"m/s",1,"meter per second"));o.addUnit("km/h",1/3.6,"kilometer per hour");o.addUnit("c",299792458,"proportion of speed of light");return o}return t}(n)},{"./multi-unit-input.js":27}],34:[function(e,t,i){var n=e("../animation/animation.js");var o=e("../content/content.js");var a=e("../astrosim.js"),s=a.mainLoop;var r=e("../serialization/serializer.js");var l=e("../ui/ui.js");t.exports=function(){var e=this;document.getElementById("serialize-button").addEventListener("click",function(){var e=r.createData();r.serialize(e)},{passive:true});this.togglePauseButton.addEventListener("click",function(){if(s.running){l.pause()}else{l.unpause()}},{passive:true});document.getElementById("open-new-object-dialog").addEventListener("click",this.dialogs.newObjectDialog.open.bind(this.dialogs.newObjectDialog),{passive:true});document.getElementById("open-about").addEventListener("click",this.dialogs.aboutDialog.open.bind(this.dialogs.aboutDialog),{passive:true});document.getElementById("open-details").addEventListener("click",function(){l.updateHistory();e.dialogs.detailsDialog.open()},{passive:true});document.getElementById("object-delete").addEventListener("click",function(){var t=o.editedObject;o.remove(t);e.update();n.shouldRender=true;e.dialogs.objectDialog.close()},{passive:true});document.getElementById("object-cancel").addEventListener("click",this.dialogs.objectDialog.close.bind(this.dialogs.objectDialog));document.getElementById("new-object-cancel").addEventListener("click",this.dialogs.newObjectDialog.close.bind(this.dialogs.newObjectDialog));document.getElementById("open-settings-dialog").addEventListener("click",function(){var t=e.dialogs.settingsDialog;t.setValues();t.open()},{passive:true});document.getElementById("open-scene").addEventListener("click",this.dialogs.sceneDialog.open.bind(this.dialogs.sceneDialog));document.getElementById("cancel-scene").addEventListener("click",function(){e.dialogs.sceneDialog.hideError();e.dialogs.sceneDialog.close()},{passive:true});document.getElementById("settings-cancel").addEventListener("click",this.dialogs.settingsDialog.close.bind(this.dialogs.settingsDialog),{passive:true});var t=document.getElementById("open-side-bar");t.addEventListener("click",l.openSideBar.bind(l));document.getElementById("close-side-bar").addEventListener("click",function(){l.closeSideBar();t.focus()},{passive:true});l.keyboard.on("Enter",function(){if(l.dialogs.openDialog){l.dialogs.openDialog.submit()}else if(document.activeElement===document.body){if(s.running){l.pause()}else{l.unpause()}}});l.keyboard.on("i",function(){if(s.running){l.pause()}else{l.unpause()}});l.keyboard.on("keyup",function(e){if(l.dialogs.openDialog){return}var t=Number(e.key);if(t===0){t=10}if(t>0&&t<11){if(o.objects[t-1]){if(!l.keyboard.isKeyPressed("o")){l.addObjectToSelection(o.objects[t-1])}else{l.openEditObject(o.objects[t-1])}}}});l.keyboard.on("a",function(){if(!l.dialogs.openDialog){l.dialogs.newObjectDialog.open()}});l.keyboard.on("s",function(){if(!l.dialogs.openDialog){l.dialogs.sceneDialog.open()}});l.keyboard.on("q",function(e){if(!l.dialogs.openDialog){l.selectedObjects=[];l.updateSelection()}});l.keyboard.on("p",function(){if(!l.dialogs.openDialog){l.dialogs.settingsDialog.open()}});l.keyboard.on("x",function(){if(n.dragging&&l.dialogs.openDialog){n.dragging=false;l.dialogs.openDialog.show()}});l.keyboard.on("Escape",function(){if(l.dialogs.openDialog){l.dialogs.openDialog.close()}});l.keyboard.on("n",function(){if(document.activeElement===document.body){l.toggleSideBar()}});l.keyboard.on("m",function(){if(!l.dialogs.openDialog){n.translation[0]=0;n.translation[1]=0;n.shouldRender=true}})}},{"../animation/animation.js":1,"../astrosim.js":7,"../content/content.js":9,"../serialization/serializer.js":20,"../ui/ui.js":36}],35:[function(e,t,i){var n=e("../content/event-emitter.js");t.exports=function(e){_inherits(t,e);function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.pressedKeys={};document.addEventListener("keydown",function(t){e.pressedKeys[t.key]=true;e.emit("keydown",t)},{passive:true});document.addEventListener("keyup",function(t){e.pressedKeys[t.key]=false;e.emit(t.key,t);e.emit("keyup",t)});return e}_createClass(t,[{key:"isKeyPressed",value:function e(t){return!!this.pressedKeys[t]}}]);return t}(n)},{"../content/event-emitter.js":10}],36:[function(e,t,i){var n=e("../astrosim.js");var o=n.mainLoop;var a=void 0;var s=e("./keyboard.js");var r=e("../content/body.js");var l=e("../animation/animation.js");var c=t.exports=n.ui={selectedObjects:[],historyObject:null,isPlaying:true,dialogs:e("./dialogs/dialog-manager.js"),keyboard:new s,sideBar:null,initialize:function t(){this.list=document.getElementById("object-list");this.historyTable=document.getElementById("history");this.togglePauseButton=document.getElementById("toggle-pause-button");this.sideBar=document.getElementById("side-bar");a=e("../content/content.js");this.dialogs.initialize();e("./event-listeners.js").call(this)},update:function e(){var t=void 0;var i=this.list;while(i.firstChild){i.removeChild(i.firstChild)}var n=document.createDocumentFragment();var o=a,s=o.objects;for(t in s){var r=s[t];var l=document.createElement("div");l.classList.add("object-list-item");var u=document.createElement("div");u.classList.add("object-list-item-before");u.style.backgroundColor=r.color.hexString();var d=document.createElement("span");d.appendChild(u);d.appendChild(document.createTextNode(r.name||"Object #"+r.id));var v=document.createElement("button");v.classList.add("edit-button");v.addEventListener("click",c.openEditObject.bind(c,r));var h=document.createElement("button");h.classList.add("center-button");h.addEventListener("click",c.addObjectToSelection.bind(c,r));var m=document.createElement("div");m.appendChild(v);m.appendChild(h);l.appendChild(d);l.appendChild(m);n.appendChild(l)}i.appendChild(n);this.updateSelection()},addObjectToSelection:function e(t){var i=this.selectedObjects;var n=void 0;if((n=i.indexOf(t))>-1){i.splice(n,1)}else{i.push(t)}this.updateSelection();l.shouldRender=true},openEditObject:function e(t){a.editedObject=t;var i=this.dialogs.objectDialog;i.setValues();i.open()},updateSelection:function e(){var t=c.selectedObjects;var i=t.map(function(e,t){return e.id});var n=this.list;var o=Array.from(n.children);var a=o.length;var s=void 0;for(s in o){var r=o[s];if(i.indexOf(s)>-1){r.classList.add("selected-object")}else{r.classList.remove("selected-object")}}},updateHistory:function e(){var t=a,i=t.objects;var n=this.historyTable;var o=n.firstChild.nextElementSibling.nextElementSibling;while(o){var s=o;o=s.nextSibling;n.removeChild(s)}var r=0,l=0;for(r in i){var u=document.createElement("tr");var d=i[r];for(l=0;l<7;l+=1){var v=document.createElement("td");u.appendChild(v)}var h=document.createElement("span");h.classList.add("details-list-item-before");h.style.backgroundColor=d.color.hexString();h.addEventListener("click",c.updateHistoryValues.bind(c,d));var m=document.createElement("span");m.textContent=d.name;u.children[0].appendChild(h);u.children[0].appendChild(m);n.appendChild(u)}this.updateHistoryValues()},updateHistoryValues:function e(t){var i=a,n=i.objects;if(!t){return}var o=void 0;var s=n.length;for(o=0;o<s;o+=1){var r=this.historyTable.children[o+1];if(o===t.id){r.children[1].textContent="-";r.children[2].textContent="-";r.children[3].textContent="-";r.children[4].textContent="-";r.children[5].textContent="-";r.children[6].textContent="-"}else{var l=a.histories[t.id][o];r.children[1].textContent=l.force.average.toExponential(3);r.children[2].textContent=l.force.min.toExponential(3);r.children[3].textContent=l.force.max.toExponential(3);r.children[4].textContent=l.distance.average.toExponential(3);r.children[5].textContent=l.distance.min.toExponential(3);r.children[6].textContent=l.distance.max.toExponential(3)}}},pause:function e(){if(l.dragging){return}l.pause();this.isPlaying=false;this.togglePauseButton.textContent="Play";this.togglePauseButton.classList.add("play-button");this.togglePauseButton.classList.remove("pause-button")},unpause:function e(){if(l.dragging){return}l.unpause();this.isPlaying=true;this.togglePauseButton.textContent="Pause";this.togglePauseButton.classList.remove("play-button");this.togglePauseButton.classList.add("pause-button")},openSideBar:function e(){this.sideBar.classList.remove("side-bar-closed")},closeSideBar:function e(){this.sideBar.classList.add("side-bar-closed")},toggleSideBar:function e(){if(this.sideBar.classList.contains("side-bar-closed")){this.sideBar.classList.remove("side-bar-closed")}else{this.sideBar.classList.add("side-bar-closed")}}}},{"../animation/animation.js":1,"../astrosim.js":7,"../content/body.js":8,"../content/content.js":9,"./dialogs/dialog-manager.js":23,"./event-listeners.js":34,"./keyboard.js":35}]},{},[7]);
=======
"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var _slicedToArray=function(){function e(e,t){var n=[];var i=true;var o=false;var a=undefined;try{for(var s=e[Symbol.iterator](),r;!(i=(r=s.next()).done);i=true){n.push(r.value);if(t&&n.length===t)break}}catch(e){o=true;a=e}finally{try{if(!i&&s["return"])s["return"]()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,n)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,n,i){if(n)e(t.prototype,n);if(i)e(t,i);return t}}();function _possibleConstructorReturn(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}(function e(t,n,i){function o(s,r){if(!n[s]){if(!t[s]){var l=typeof require=="function"&&require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return o(n?n:e)},u,u.exports,e,t,n,i)}return n[s].exports}var a=typeof require=="function"&&require;for(var s=0;s<i.length;s++){o(i[s])}return o})({1:[function(e,t,n){var i=e("../astrosim.js");var o=e("./loop.js");var a=i.mainLoop;var s=e("../content/vec2.js");var r=void 0;var l=t.exports=i.animation={MIN_SCALING:2e-10,MAX_SCALING:2e10,translation:s.create(0,0),ratio:1,size:0,width:0,height:0,canvas:null,textCanvas:null,ctx:null,textCtx:null,frames:0,framesPerSecond:0,traceFrequency:10,shouldRender:true,drawHistory:true,drawControls:true,drawLabels:false,dragging:false,draggingPositionStart:s.create(),draggingPositionEnd:s.create(),draggingRadius:1,draggingCenter:false,draggingColor:"#FFFFFF",mouseHeld:false,animationLoop:new o(function(){if(l.shouldRender){l.render();l.renderControls();l.shouldRender=false}else if(a.running){if(l.frames%3===0){l.render()}if(l.frames%30===0){l.renderControls()}l.frames+=1}}),adjust:function e(){this.width=this.canvas.width=this.textCanvas.width=window.innerWidth;this.height=this.canvas.height=this.textCanvas.height=window.innerHeight;this.translation[0]=0;this.translation[1]=0;this.ratio=1;this.shouldRender=true},initialize:function t(){var n=this.canvas=document.getElementById("canvas");var i=this.textCanvas=document.getElementById("text-canvas");this.ctx=n.getContext("2d",{alpha:false});this.textCtx=i.getContext("2d");this.adjust();r=e("../ui/ui.js");e("./transformation.js");e("./render.js");e("./event-listeners.js")();this.animationLoop.start()},pause:function e(){a.pause()},unpause:function e(){a.unpause()}}},{"../astrosim.js":7,"../content/vec2.js":12,"../ui/ui.js":36,"./event-listeners.js":3,"./loop.js":4,"./render.js":5,"./transformation.js":6}],2:[function(e,t,n){t.exports=function(){function e(t,n,i){_classCallCheck(this,e);this.r=e.getInt(t||0);this.g=e.getInt(n||0);this.b=e.getInt(i||0)}_createClass(e,[{key:"copy",value:function t(){return new e(this.r,this.g,this.b)}},{key:"interpolate",value:function t(n){if(!(n instanceof e)){return this.copy()}var i=(this.r+n.r)/2;var o=(this.g+n.g)/2;var a=(this.b+n.b)/2;return new e(i,o,a)}},{key:"hexString",value:function t(){var n=e.decToHex(this.r);var i=e.decToHex(this.g);var o=e.decToHex(this.b);return"#"+n+i+o}}],[{key:"fromHexString",value:function t(n){var i=e.hexToDec(n.slice(1,3));var o=e.hexToDec(n.slice(3,5));var a=e.hexToDec(n.slice(5,7));return new e(i,o,a)}},{key:"getInt",value:function t(n){var i=n;if(typeof n==="string"){i=e.hexToDec(n)}if(typeof i!=="number"){return 0}if(i>255){return 255}if(i<0){return 0}return Math.round(i)}},{key:"decToHex",value:function e(t){var n=t.toString(16);return n.length<2?"0"+n:n}},{key:"hexToDec",value:function e(t){return parseInt(t,16)}}]);return e}()},{}],3:[function(e,t,n){var i=e("./animation.js");var o=e("../astrosim.js"),a=o.mainLoop;var s=e("../ui/dialogs/dialog-manager.js");var r=e("../ui/ui.js");t.exports=function(){var e=i.textCanvas;window.addEventListener("resize",function(){i.adjust()},{passive:true});e.addEventListener("wheel",function(t){var n=t.deltaY>0?.5:2;var o=t.clientX-e.offsetLeft||e.width/2;var a=t.clientY-e.offsetTop||e.height/2;i.scale(n,o-e.width/2,a-e.height/2)},{passive:true});var t=0,n=0,o=0;e.addEventListener("mousedown",function(e){i.mouseHeld=true;if(i.dragging){i.draggingPositionStart[0]=e.clientX;i.draggingPositionStart[1]=e.clientY;return}t=e.clientX;n=e.clientY;document.body.position="fixed"},{passive:true});e.addEventListener("touchstart",function(t){t.preventDefault();var n=t.touches;if(n.length>1){var i=n[0].clientX-n[1].clientX;var a=n[0].clientY-n[1].clientY;o=Math.sqrt(i*i+a*a)}e.dispatchEvent(new MouseEvent("mousedown",{clientX:n[0].clientX,clientY:n[0].clientY}))});e.addEventListener("touchmove",function(t){t.preventDefault();var n=t.touches;if(n.length===1){e.dispatchEvent(new MouseEvent("mousemove",{clientX:n[0].clientX,clientY:n[0].clientY}))}else if(n.length>1){var a=n[0].clientX-n[1].clientX;var s=n[0].clientY-n[1].clientY;var r=Math.sqrt(a*a+s*s);var l=n[0].clientX+a/2-e.width/2;var c=n[0].clientY+s/2-e.height/2;var u=r/o;i.scale(u,l,c);o=r}});e.addEventListener("touchend",function(t){t.preventDefault();e.dispatchEvent(new MouseEvent("mouseup",{}))});e.addEventListener("touchcancel",function(t){t.preventDefault();e.dispatchEvent(new MouseEvent("mouseup",{}))});e.addEventListener("mousemove",function(o){if(i.dragging){if(o.clientX>e.width*.95){i.translate(1,0);i.draggingPositionStart[0]-=1;i.draggingPositionEnd[0]-=1}else if(o.clientX<e.width*.05){i.translate(-1,0);i.draggingPositionStart[0]+=1;i.draggingPositionEnd[0]+=1}else if(o.clientY>e.height*.95){i.translate(0,1);i.draggingPositionStart[1]-=1;i.draggingPositionEnd[1]-=1}else if(o.clientY<e.height*.05){i.translate(0,-1);i.draggingPositionStart[1]+=1;i.draggingPositionEnd[1]+=1}if(i.mouseHeld){i.draggingPositionEnd[0]=o.clientX;i.draggingPositionEnd[1]=o.clientY}else{i.draggingPositionStart[0]=i.draggingPositionEnd[0]=o.clientX;i.draggingPositionStart[1]=i.draggingPositionEnd[1]=o.clientY}i.shouldRender=true;return}if(!i.mouseHeld){return}i.translate(t-o.clientX,n-o.clientY);document.body.position="absolute";t=o.clientX;n=o.clientY},{passive:true});e.addEventListener("mouseup",function(e){if(i.dragging&&s.openDialog){s.openDialog.emit("drag-end")}},{passive:true});document.body.addEventListener("mouseup",function(){i.mouseHeld=false},{passive:true});r.keyboard.on("keyup",function(e){if(!s.openDialog){var t=e.shiftKey?10:100;if(e.key==="ArrowUp"){i.translate(0,t)}else if(e.key==="ArrowDown"){i.translate(0,-t)}else if(e.key==="ArrowLeft"){i.translate(t,0)}else if(e.key==="ArrowRight"){i.translate(-t,0)}else if(e.key==="+"||e.key==="*"){i.scale(e.shiftKey?1.05:2,0,0)}else if(e.key==="-"||e.key==="_"){i.scale(e.shiftKey?.95:.5,0,0)}else if(e.key==="t"){i.drawHistory=!i.drawHistory;i.shouldRender=true}else if(e.key==="c"){i.drawControls=!i.drawControls;i.shouldRender=true}else if(e.key==="l"){i.drawLabels=!i.drawLabels;i.shouldRender=true}}})}},{"../astrosim.js":7,"../ui/dialogs/dialog-manager.js":23,"../ui/ui.js":36,"./animation.js":1}],4:[function(e,t,n){t.exports=function(){function e(t,n){var i=this;_classCallCheck(this,e);this.running=false;this.started=false;this.stopped=false;this.interval=typeof n==="number"&&n>0?n:null;var o=Date.now();var a=function e(){var n=Date.now();if(i.running){t(n-o)}o=n;if(i.interval){window.setTimeout(e,i.interval)}else{window.requestAnimationFrame(e)}};window.requestAnimationFrame(a)}_createClass(e,[{key:"start",value:function e(){if(this.stopped){return false}this.running=true;this.started=true;return true}},{key:"pause",value:function e(){this.running=false;return true}},{key:"unpause",value:function e(){return!this.stopped&&(this.running=true)}},{key:"togglePause",value:function e(){return this.running?this.pause():this.unpause()}},{key:"stop",value:function e(){this.running=false;this.stopped=true;return true}}]);return e}()},{}],5:[function(e,t,n){var i=e("../content/content.js");var o=e("./animation.js");var a=e("../content/body.js");var s=e("../ui/ui.js");var r=e("../content/vec2.js");o.drawCircle=function(e,t,n,i){var o=this.canvas,a=this.ctx;if(e-n>o.width||e+n<0||t-n>o.height||t+n<0){return}a.fillStyle=i;a.beginPath();a.moveTo(e,t-n);a.arc(e,t,n,0,Math.PI*2,true);a.fill()};o.renderControls=function(){var e=this.translation,t=this.ratio;var n=this.textCanvas;var a=this.textCtx;a.clearRect(0,0,n.width,n.height);if(!o.drawControls){return}a.fillStyle="#FFFFFF";var s=200;var r=(s*i.METERS_PER_PIXEL/this.ratio).toExponential(2);a.fillRect(n.width-s-20,n.height-22,s,2);a.textAlign="center";a.fillText(r+"m",n.width-s/2-20,n.height-40);a.textAlign="right";a.fillText("Simulated time: "+i.simulatedTime.toExponential(1)+"s",n.width-20,20);a.fillText("Real time: "+Math.round(i.realTime).toString()+"s",n.width-20,40);a.fillText("Ticks: "+i.ticks.toExponential(1),n.width-20,60);var l=Math.round(o.frames/3/i.realTime);a.fillText("FPS: "+(isNaN(l)?0:l),n.width-20,80);if(o.dragging){a.fillStyle="#000000";a.fillRect(n.width/2-100,84,200,22);a.fillStyle="#FFFFFF";a.textAlign="center";a.fillText("Click to select a position or hit X to return.",n.width/2,100)}};o.render=function(){var e=this.ctx,t=this.canvas,n=this.translation;var a=i.objects;e.clearRect(0,0,t.width,t.height);if(s.selectedObjects.length>0){this.center(r.scale(r.center(s.selectedObjects.map(function(e){return e.position}),i.temp1),1/i.METERS_PER_PIXEL,i.temp1))}if(a.length>0){var l=i.temp1;l[0]=t.width/2;l[1]=t.height/2;var c=i.temp2;var u=this.translation[0]+l[0];var d=this.translation[1]+l[1];var v=this.ratio/i.METERS_PER_PIXEL;var h=void 0;for(h in a){var m=a[h];r.scale(m.position,v,c);c[0]+=u;c[1]+=d;var g=m.radius*this.ratio/i.METERS_PER_PIXEL;var f=m.color.hexString();this.drawCircle(c[0],c[1],Math.max(g,3),f);if(o.drawLabels){e.textAlign="left";e.fillText(m.name,c[0]+g+3,c[1])}if(o.drawHistory){e.beginPath();e.strokeStyle=f;var p=void 0;var y=m.history;if(m.historyOverflow){var b=y.length;e.moveTo(y[m.historyIndex]*v+u,y[m.historyIndex+1]*v+d);for(p=m.historyIndex+2;p<b;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}for(p=0;p<m.historyIndex;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}}else{e.moveTo(y[0]*v+u,y[1]*v+d);for(p=2;p<m.historyIndex;p+=2){e.lineTo(y[p]*v+u,y[p+1]*v+d)}}e.lineTo(c[0],c[1]);e.stroke()}}}if(o.dragging){if(o.draggingCenter){var j=_slicedToArray(o.draggingPositionEnd,2),E=j[0],w=j[1];e.strokeStyle=o.draggingColor;e.beginPath();e.moveTo(E,w-10);e.lineTo(E,w+10);e.moveTo(E-10,w);e.lineTo(E+10,w);e.stroke()}else{var k=o.draggingPositionStart;var x=o.draggingRadius*this.ratio/i.METERS_PER_PIXEL;var C=o.draggingColor;this.drawCircle(k[0],k[1],Math.max(x,3),C);if(o.mouseHeld){var I=o.draggingPositionEnd;e.strokeStyle="#FFFFFF";e.beginPath();e.moveTo(k[0],k[1]);e.lineTo(I[0],I[1]);e.stroke()}}}if(o.drawControls){var _=n[0]+t.width/2;var L=n[1]+t.height/2;e.strokeStyle="#FFFFFF";e.beginPath();e.moveTo(_,L-10);e.lineTo(_,L+10);e.moveTo(_-10,L);e.lineTo(_+10,L);e.stroke();return}}},{"../content/body.js":8,"../content/content.js":9,"../content/vec2.js":12,"../ui/ui.js":36,"./animation.js":1}],6:[function(e,t,n){var i=e("./animation.js");var o=e("../content/vec2.js");i.center=function(e){o.scale(e,-this.ratio,this.translation)};i.translate=function(e,t){i.translation[0]-=e;i.translation[1]-=t;i.shouldRender=true};i.scale=function(e,t,n){var o=i.ratio*e;if(o<i.MIN_SCALING){return}if(o>i.MAX_SCALING){return}i.ratio=o;var a=((t||0)-i.translation[0])/i.width;var s=((n||0)-i.translation[1])/i.height;i.width=canvas.width*o;i.height=canvas.height*o;var r=i.width*a-t;var l=i.height*s-n;i.translation[0]=-r;i.translation[1]=-l;i.shouldRender=true}},{"../content/vec2.js":12,"./animation.js":1}],7:[function(e,t,n){var i=e("./animation/loop.js");var o=t.exports={mainLoop:new i(function(e){o.content.update(e)})};document.addEventListener("DOMContentLoaded",function(){o.animation=e("./animation/animation.js");o.content=e("./content/content.js");o.ui=e("./ui/ui.js");o.animation.initialize();o.content.initialize();o.ui.initialize();o.mainLoop.start()},{passive:true})},{"./animation/animation.js":1,"./animation/loop.js":4,"./content/content.js":9,"./ui/ui.js":36}],8:[function(e,t,n){var i=e("../animation/color.js");var o=e("./content.js");var a=e("./vec2.js");t.exports=function(){function e(t,n,o,s){_classCallCheck(this,e);this.position=t;this.velocity=a.create();this.mass=n||0;this.radius=o;this.color=new i;this.name=s;this.history=new Float32Array(200);this.historyIndex=0;this.historyOverflow=false;this.history[0]=t[0];this.history[1]=t[1]}_createClass(e,[{key:"applyForce",value:function e(t){var n=1/this.mass;this.velocity[0]+=t[0]*n;this.velocity[1]+=t[1]*n}},{key:"serialize",value:function e(){return{positionX:this.position[0],positionY:this.position[1],velocityX:this.velocity[0],velocityY:this.velocity[1],mass:this.mass,radius:this.radius,color:this.color.hexString(),name:this.name}}},{key:"move",value:function e(t){this.position[0]+=this.velocity[0]*t;this.position[1]+=this.velocity[1]*t}},{key:"savePosition",value:function e(){this.history[this.historyIndex]=this.position[0];this.history[this.historyIndex+1]=this.position[1];this.historyIndex+=2;if(this.historyIndex>=this.history.length){this.historyIndex=0;this.historyOverflow=true}}},{key:"clearHistory",value:function e(){this.historyIndex=0;this.historyOverflow=false}},{key:"update",value:function e(t){var n=o.objects;var i=void 0;for(i in n){var a=n[i];if(a===this||a.id===this.id){continue}if(!this.interact(a,n,i,t)){return}}}},{key:"interact",value:function t(n,i,s,r){var l=a.subtract(this.position,n.position,o.temp1);var c=a.getLength(l)||1e-10;if(isNaN(l[0])||isNaN(l[1])){l[0]=l[1]=0}if(c<this.radius){var u=a.weighedCenter(this.position,this.mass,n.position,n.mass,l);var d=Math.pow(4/3*Math.PI*Math.pow(this.radius,3)+4/3*Math.PI*Math.pow(n.radius,3),1/3);var v=new e(a.copy(u),this.mass+n.mass,d,this.name+"+"+n.name);o.remove(n);o.remove(this);var h=a.scale(this.velocity,this.mass,o.temp2);var m=a.scale(n.velocity,n.mass,o.temp3);a.add(h,m,v.velocity);a.scale(v.velocity,1/v.mass,v.velocity);v.color=this.color.interpolate(n.color);o.add(v);return false}var g=o.temp2;a.scale(a.normalize(l,o.temp3),-r*o.GRAVITY_CONSTANT*(this.mass*n.mass)/(c*c),g);this.applyForce(g);o.save(this.id,n.id,a.getLength(g),a.getLength(l));return true}}],[{key:"fromSerialized",value:function t(n){if(!n){return null}var o=new e(a.create(typeof n.positionX==="number"?n.positionX:0,typeof n.positionY==="number"?n.positionY:0),typeof n.mass==="number"?n.mass:1e3,typeof n.radius==="number"?n.radius:1e3,typeof n.name==="string"?n.name:"Object");o.color=i.fromHexString(n.color);o.velocity[0]=typeof n.velocityX==="number"?n.velocityX:0;o.velocity[1]=typeof n.velocityY==="number"?n.velocityY:0;return o}}]);return e}()},{"../animation/color.js":2,"./content.js":9,"./vec2.js":12}],9:[function(e,t,n){var i=e("../animation/animation.js");var o=e("../astrosim.js");var a=e("./history.js");var s=e("./vec2.js");var r=t.exports=o.content={editedObject:null,objects:[],currentId:0,METERS_PER_PIXEL:3e8,GRAVITY_CONSTANT:6.67408e-11,toBeDeleted:[],ticks:0,realTime:0,simulatedTime:0,pendingTicks:0,TICKS_PER_FRAME:10,TIME_FACTOR:1,temp1:s.create(),temp2:s.create(),temp3:s.create(),histories:[],initialize:function e(){this.TIME_FACTOR=31556927/12},add:function e(){var t=this.objects;var n=void 0;for(n in arguments){var i=arguments[n];i.id=t.push(i)-1;this.addHistory(i.id)}o.ui.update()},addHistory:function e(t){var n=this.histories;var i=n.length;n[t]=[];var o=void 0;for(o=0;o<i;o+=1){if(o!==t){var s=new a;var r=new a;var l={force:s,distance:r};n[o][t]=l;n[t][o]=l}}},save:function e(t,n,i,o){if(this.histories[t]&&this.histories[t][n]){this.histories[t][n].force.add(i);this.histories[t][n].distance.add(o)}},remove:function e(t){this.toBeDeleted.push(t.id)},commitRemove:function e(){var t=this.histories,n=this.toBeDeleted,i=this.objects;var a=void 0;for(a in n){var s=n[a];var r=void 0;for(r in t){if(r!==s){t[r].splice(s,1)}}t.splice(s,1);i.splice(s,1);for(r in i){i[r].id=Number(r)}}this.toBeDeleted=[];o.ui.update()},update:function e(t){var n=this.objects;if(this.pendingTicks>100){this.TICKS_PER_FRAME-=1}this.pendingTicks+=this.TICKS_PER_FRAME;var o=t<1e3?t:1e3;var a=o/1e3*this.TIME_FACTOR/this.TICKS_PER_FRAME;this.realTime+=o/1e3;this.simulatedTime+=a;var s=void 0;while(this.pendingTicks>0){this.ticks+=1;for(s in n){n[s].update(a)}for(s in n){n[s].move(a);if(this.ticks%i.traceFrequency===0){n[s].savePosition()}}if(this.toBeDeleted.length>0){this.commitRemove()}this.pendingTicks-=1}},momentum:function e(){return this.objects.reduce(function(e,t){return s.add(e,s.scale(t.velocity,t.mass))},s.create())},velocity:function e(){return s.scale(this.momentum(),1/this.objects.reduce(function(e,t){return e+t.mass},0))}}},{"../animation/animation.js":1,"../astrosim.js":7,"./history.js":11,"./vec2.js":12}],10:[function(e,t,n){t.exports=function(){function e(){_classCallCheck(this,e);this._events=[]}_createClass(e,[{key:"on",value:function e(t,n){var i=this._events;if(Array.isArray(i[t])){i[t].push(n)}else{i[t]=[n]}return this}},{key:"once",value:function e(t,n){var i=this._events;var o=function e(){n.apply(self,Array.prototype.slice.call(arguments));i[t].splice([i[t].indexOf(e)],1)};if(Array.isArray(i[t])){i[t].push(o)}else{i[t]=[o]}return this}},{key:"emit",value:function e(t){var n=this._events;var i=Array.prototype.slice.call(arguments,1);if(Array.isArray(n[t])){n[t].forEach(function(e){e.apply(self,i)})}}}]);return e}()},{}],11:[function(e,t,n){var i=t.exports=function(){function e(){_classCallCheck(this,e);this.average=0;this.min=0;this.max=0;this.count=0}_createClass(e,[{key:"add",value:function e(t){if(t<this.min||this.count===0){this.min=t}if(t>this.max||this.count===0){this.max=t}this.average=(this.average*this.count+t)/(this.count+=1)}}]);return e}()},{}],12:[function(e,t,n){t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"create",value:function e(t,n){var i=new Float32Array(2);i[0]=t||0;i[1]=n||0;return i}},{key:"copy",value:function t(n,i){var o=i;if(!o){o=e.create(n[0],n[1])}else{o[0]=n[0];o[1]=n[1]}return o}},{key:"weighedCenter",value:function t(n,i,o,a,s){var r=s;if(!r){r=e.create()}var l=a/(i+a);r[0]=l*(o[0]-n[0]||1e-10)+n[0];r[1]=l*(o[1]-n[1]||1e-10)+n[1];return r}},{key:"center",value:function t(n,i){var o=i;if(!o){o=e.create()}var a=void 0,s=0,r=0,l=0;for(a in n){s=(s*l+n[a][0])/(l+1);r=(r*l+n[a][1])/(l+1);l+=1}o[0]=s;o[1]=r;return o}},{key:"add",value:function t(n,i,o){var a=o;if(!a){a=e.create()}a[0]=n[0]+i[0];a[1]=n[1]+i[1];return a}},{key:"subtract",value:function t(n,i,o){var a=o;if(!a){a=e.create()}a[0]=n[0]-i[0];a[1]=n[1]-i[1];return a}},{key:"getLength",value:function e(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}},{key:"getAngle",value:function e(t){if(t[0]===0){return t[1]>0?Math.PI/2:-Math.PI/2}return Math.atan(t[1]/t[0])}},{key:"rotate",value:function t(n,i,o){var a=o;if(!a){a=e.create()}var s=Math.sin(i);var r=Math.cos(i);a[0]=n[0]*r-n[1]*s;a[1]=n[0]*s+n[1]*r;return a}},{key:"normalize",value:function t(n,i){var o=i;if(!o){o=e.create()}var a=e.getLength(n);o[0]=n[0]/a;o[1]=n[1]/a;return o}},{key:"scale",value:function t(n,i,o){var a=o;if(!a){a=e.create()}a[0]=n[0]*i;a[1]=n[1]*i;return a}}]);return e}()},{}],13:[function(e,t,n){t.exports={meta:{name:"Earth and Moon",description:"Shows the moon orbiting the earth."},viewport:{translationX:0,translationY:0,ratio:250},content:{selectedObjectIndices:[],timeFactor:1e5,objects:[{name:"Earth",positionX:0,positionY:0,velocityX:0,velocityY:-12.58,mass:5.974e24,radius:6367467.5,color:"#0000ff"},{name:"Moon",positionX:3844e5,positionY:0,velocityX:0,velocityY:1023,mass:7.349e22,radius:1738e3,color:"#888888"}]}}},{}],14:[function(e,t,n){t.exports={meta:{name:"Empty Scene",description:"Empty Scene."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[]}}},{}],15:[function(e,t,n){t.exports=[e("./earth-moon.json"),e("./empty.json"),e("./solar-system.json"),e("./sun-earth.json"),e("./trappist-1.json")]},{"./earth-moon.json":13,"./empty.json":14,"./solar-system.json":16,"./sun-earth.json":17,"./trappist-1.json":18}],16:[function(e,t,n){t.exports={meta:{name:"Solar System",description:"A scene containing the sun and our planets (including Pluto)."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[{name:"Sun",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.9884e30,radius:14e8,color:"#ffff00"},{name:"Mercury",positionX:57909e6,positionY:0,velocityX:0,velocityY:47360,mass:3.301e23,radius:244e4,color:"#bb8800"},{name:"Venus",positionX:0,positionY:10816e7,velocityX:-35020,velocityY:0,mass:4.869e24,radius:6051800,color:"#dddd44"},{name:"Earth",positionX:-1496e8,positionY:0,velocityX:0,velocityY:-29780,mass:5.974e24,radius:6367467.5,color:"#0000ff"},{name:"Moon",positionX:-1492156e5,positionY:0,velocityX:0,velocityY:-30803,mass:7.349e22,radius:1738e3,color:"#888888"},{name:"Mars",positionX:0,positionY:-22799e7,velocityX:24130,velocityY:0,mass:6.419e23,radius:3386200,color:"#ff0000"},{name:"Jupiter",positionX:77836e7,positionY:0,velocityX:0,velocityY:13070,mass:1.899e27,radius:69173e3,color:"#bbaa88"},{name:"Saturn",positionX:0,positionY:14335e8,velocityX:-9690,velocityY:0,mass:5.685e26,radius:57316e3,color:"#ffaa00"},{name:"Uranus",positionX:-28724e8,positionY:0,velocityX:0,velocityY:-6810,mass:8.683e25,radius:25266e3,color:"#dddfff"},{name:"Neptune",positionX:0,positionY:-44984e8,velocityX:5430,velocityY:0,mass:1.0243e26,radius:24552500,color:"#00045b"},{name:"Pluto",positionX:59064e8,positionY:0,velocityX:0,velocityY:4670,mass:1.303e22,radius:2374,color:"#777733"}]}}},{}],17:[function(e,t,n){t.exports={meta:{name:"Sun and Earth",description:""},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e6,objects:[{name:"Sun",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.9884e30,radius:14e8,color:"#ffff00"},{name:"Earth",positionX:148999995392,positionY:0,velocityX:0,velocityY:29780,mass:5.974e24,radius:6e6,color:"#0000ff"}]}}},{}],18:[function(e,t,n){t.exports={meta:{name:"TRAPPIST-1",description:"The 2MASS J23062928-0502285 system (also known as TRAPPIST-1A). Note that Trappist-1h's mass is unknown."},viewport:{translationX:0,translationY:0,ratio:1},content:{selectedObjectIndices:[],timeFactor:1e4,objects:[{name:"Trappist-1",positionX:0,positionY:0,velocityX:0,velocityY:0,mass:1.6309144e29,radius:81472014,color:"#ffb257"},{name:"Trappist-1b",positionX:165539e4,positionY:0,velocityX:0,velocityY:79998.97961860064,mass:5.07637e24,radius:6918906,color:"#f9882a"},{name:"Trappist-1c",positionX:0,positionY:226778e4,velocityX:-68370.68304792153,velocityY:0,mass:8.241636e24,radius:6727776,color:"#d38c43"},{name:"Trappist-1d",positionX:-3129e6,positionY:0,velocityX:0,velocityY:-56416.19787734072,mass:2.448602e24,radius:4918412,color:"#ab8359"},{name:"Trappist-1e",positionX:0,positionY:-4172e6,velocityX:49940.55069291154,velocityY:0,mass:3.702764e24,radius:5848578,color:"#aa8677"},{name:"Trappist-1f",positionX:5513e6,positionY:0,velocityX:0,velocityY:43721.587579426,mass:4.061096e24,radius:6657695,color:"#846a63"},{name:"Trappist-1g",positionX:0,positionY:6705e6,velocityX:-39631.44443220881,velocityY:0,mass:8.002748e24,radius:7180117,color:"#a39d6a"},{name:"Trappist-1h",positionX:-9387e6,positionY:0,velocityX:0,velocityY:-34269.539862908656,mass:1,radius:4810105,color:"#ddae83"}]}}},{}],19:[function(e,t,n){var i=e("../animation/animation.js");var o=e("../content/body.js");var a=e("../content/content.js");var s=e("../ui/ui.js");var r=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"selectScene",value:function e(t){a.objects=[];a.histories=[];a.currentId=a.realTime=a.simulatedTime=a.ticks=a.pendingTicks=0;a.add.apply(a,t.content.objects.map(function(e){return o.fromSerialized(e)}));a.TIME_FACTOR=t.content.timeFactor;i.frames=0;i.translation[0]=t.viewport.translationX;i.translation[1]=t.viewport.translationY;i.ratio=t.viewport.ratio;i.width=i.canvas.width*i.ratio;i.height=i.canvas.height*i.ratio;s.selectedObjects=t.content.selectedObjectIndices.map(function(e){return a.objects[e]});i.shouldRender=true;s.pause()}},{key:"validateData",value:function e(t){return(typeof t==="undefined"?"undefined":_typeof(t))==="object"&&_typeof(t.meta)==="object"&&typeof t.meta.name==="string"&&typeof t.meta.description==="string"&&_typeof(t.viewport)==="object"&&typeof t.viewport.translationX==="number"&&!isNaN(t.viewport.translationX)&&typeof t.viewport.translationY==="number"&&!isNaN(t.viewport.translationY)&&typeof t.viewport.ratio==="number"&&!isNaN(t.viewport.ratio)&&t.viewport.ratio>0&&_typeof(t.content)==="object"&&typeof t.content.timeFactor==="number"&&Array.isArray(t.content.objects)&&Array.isArray(t.content.selectedObjectIndices)&&t.content.selectedObjectIndices.every(function(e){return e>-1&&e<t.content.selectedObjectIndices.length})&&t.content.objects.filter(function(e){return(typeof e==="undefined"?"undefined":_typeof(e))==="object"&&typeof e.name==="string"&&typeof e.positionX==="number"&&typeof e.positionY==="number"&&typeof e.velocityX==="number"&&typeof e.velocityY==="number"&&typeof e.mass==="number"&&e.mass>0&&typeof e.radius==="number"&&e.radius>0&&typeof e.color==="string"&&r.test(e.color)})}}]);return e}()},{"../animation/animation.js":1,"../content/body.js":8,"../content/content.js":9,"../ui/ui.js":36}],20:[function(e,t,n){var i=e("../animation/animation.js");var o=e("../content/content.js");var a=e("../ui/ui.js");t.exports=function(){function e(){_classCallCheck(this,e)}_createClass(e,null,[{key:"createData",value:function e(){var t={};t.meta={name:"AstroSim scene",description:"Your own AstroSim scene."};t.viewport={translationX:i.translation[0],translationY:i.translation[1],ratio:i.ratio};t.content={selectedObjectIndices:a.selectedObjects.map(function(e){return o.objects.indexOf(e)}).sort(),objects:o.objects.map(function(e){return e.serialize()}),timeFactor:o.TIME_FACTOR};return t}},{key:"serialize",value:function e(t){var n=document.createElement("a");var i=new Blob([JSON.stringify(t,null,"  ")],{type:"application/json"});n.href=URL.createObjectURL(i);n.download="astro-scene.json";document.body.appendChild(n);n.click();document.body.removeChild(n)}}]);return e}()},{"../animation/animation.js":1,"../content/content.js":9,"../ui/ui.js":36}],21:[function(e,t,n){var i=e("./dialog.js");var o=t.exports=new i(document.getElementById("about-dialog"));var a=document.getElementById("about-submit");o.on("open",a.focus.bind(a));a.addEventListener("click",function(){o.close()})},{"./dialog.js":24}],22:[function(e,t,n){var i=e("./dialog.js");var o=t.exports=new i(document.getElementById("details-dialog"));document.getElementById("details-submit").addEventListener("click",function(){o.close()})},{"./dialog.js":24}],23:[function(e,t,n){t.exports={aboutDialog:null,detailsDialog:null,settingsDialog:null,objectDialog:null,newObjectDialog:null,sceneDialog:null,openDialog:null,initialize:function t(){this.aboutDialog=e("./about-dialog.js");this.detailsDialog=e("./details-dialog.js");this.settingsDialog=e("./settings-dialog.js");this.objectDialog=e("./object-dialog.js");this.newObjectDialog=e("./new-object-dialog.js");this.sceneDialog=e("./scene-dialog.js")}}},{"./about-dialog.js":21,"./details-dialog.js":22,"./new-object-dialog.js":28,"./object-dialog.js":29,"./scene-dialog.js":30,"./settings-dialog.js":31}],24:[function(e,t,n){var i=e("../../animation/animation.js");var o=e("./dialog-manager.js");var a=e("../../content/event-emitter.js");var s=e("../../ui/ui.js");t.exports=function(e){_inherits(t,e);function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.element=e;e.classList.add("dialog-closed");e.classList.add("dialog");n.opened=false;n.inputs={};n.invalidInputs={};n.valid=true;return n}_createClass(t,[{key:"registerInput",value:function e(){var t=void 0;for(t in arguments){var n=arguments[t];this.inputs[n.name]=n}}},{key:"set",value:function e(t){var n=void 0;var i=this.inputs;for(n in i){var o=i[n];if(t[n]){o.value=t[n]}}}},{key:"validate",value:function e(){var t=true;var n=this.invalidInputs=[];var i=true;var o=void 0;var a=this.inputs;for(o in a){var s=a[o];if(typeof s.checkValidity==="function"){i=s.checkValidity()}else{var r=s.filterFunction||this.defaultFilterFunction;i=!!r(s,s.value,o);if(!i){n.push(s);s.classList.add("dialog-input-invalid")}else{s.classList.remove("dialog-input-invalid")}}t=t&&i}return t}},{key:"getInputByName",value:function e(t){return this.inputs[t]||null}},{key:"setFilterFunction",value:function e(t,n){t.filterFunction=n}},{key:"defaultFilterFunction",value:function e(){return true}},{key:"open",value:function e(){if(o.openDialog){return}this.element.classList.add("dialog-open");this.element.classList.remove("dialog-closed");this.opened=true;o.openDialog=this;i.pause();this.emit("open")}},{key:"show",value:function e(){this.element.classList.add("dialog-open");this.element.classList.remove("dialog-closed")}},{key:"hide",value:function e(){this.element.classList.remove("dialog-open");this.element.classList.add("dialog-closed")}},{key:"close",value:function e(){this.element.classList.remove("dialog-open");this.element.classList.add("dialog-closed");this.opened=false;o.openDialog=null;document.activeElement.blur();this.emit("close");if(s.isPlaying){i.unpause()}}},{key:"submit",value:function e(){if(this.validate()){this.emit("submit");this.close()}}}],[{key:"greaterThanZero",value:function e(t,n){var i=Number(n);return i>0}}]);return t}(a)},{"../../animation/animation.js":1,"../../content/event-emitter.js":10,"../../ui/ui.js":36,"./dialog-manager.js":23}],25:[function(e,t,n){var i=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,n,i){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,"m",1,"meter"));o.addUnit("AU",149597870700,"astronomical unit");o.addUnit("ly",94607e11,"light year");o.addUnit("pc",30857e12,"parsec");return o}return t}(i)},{"./multi-unit-input.js":27}],26:[function(e,t,n){var i=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,n,i){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,"kg",1,"kilogram"));o.addUnit("solar mass",1.98855e30,"proportion of solar mass");o.buttons["solar mass"].innerHTML='M<span class="sub">â˜‰</span>';return o}_createClass(t,[{key:"checkValidity",value:function e(){var t=this.value>0;if(t){this._inputElement.classList.remove("dialog-input-invalid")}else{this._inputElement.classList.add("dialog-input-invalid")}return t}}]);return t}(i)},{"./multi-unit-input.js":27}],27:[function(e,t,n){t.exports=function(){function e(t,n,i,o,a,s){_classCallCheck(this,e)
;this.units={};this.buttons={};this._unit=o;this.wrapperElement=t;var r=this._inputElement=document.createElement("input");this.name=r.name=n;t.appendChild(r);this.addUnit(o,a,s);this.value=i;this.setUnit(o)}_createClass(e,[{key:"addUnit",value:function e(t,n,i){this.units[t]=n;var o=document.createElement("button");o.textContent=t;o.classList.add("unit-push-button");o.addEventListener("click",this.setUnit.bind(this,t));o.setAttribute("tabindex","-1");if(i){o.title=i}this.buttons[t]=o;this.wrapperElement.appendChild(o)}},{key:"checkValidity",value:function e(){return true}},{key:"setUnit",value:function e(t){var n=this.units[t];var i=this.value;this.buttons[this._unit].classList.remove("pushed");this._unit=t;this.buttons[t].classList.add("pushed");this.value=i}},{key:"value",get:function e(){return Number(this._inputElement.value)*this.units[this._unit]},set:function e(t){this._inputElement.value=(t/this.units[this._unit]).toExponential(3)}}]);return e}()},{}],28:[function(e,t,n){var i=e("../../animation/animation.js");var o=e("./dialog.js");var a=e("../../content/vec2.js");var s=e("./length-input.js");var r=e("./unsigned-length-input.js");var l=e("./mass-input");var c=e("./velocity-input.js");var u=e("../../animation/color.js");var d=e("../../content/body.js");var v=e("../../content/content.js");var h=t.exports=new o(document.getElementById("new-object-dialog"));var m=document.getElementById("new-object-name");var g=new s(document.getElementById("new-object-position-x"),"position-x",0);var f=new s(document.getElementById("new-object-position-y"),"position-y",0);var p=new c(document.getElementById("new-object-velocity-x"),"velocity-x",0);var y=new c(document.getElementById("new-object-velocity-y"),"velocity-y",0);var b=new l(document.getElementById("new-object-mass"),"mass",0);var j=new r(document.getElementById("new-object-radius"),"radius",0);var E=document.getElementById("new-object-color");h.registerInput(m,g,f,p,y,b,j);h.on("drag-end",function(){g.value=(i.draggingPositionStart[0]-i.translation[0]-i.canvas.width/2)*v.METERS_PER_PIXEL/i.ratio;f.value=(i.draggingPositionStart[1]-i.translation[1]-i.canvas.height/2)*v.METERS_PER_PIXEL/i.ratio;p.value=(i.draggingPositionEnd[0]-i.draggingPositionStart[0])/i.ratio;y.value=(i.draggingPositionEnd[1]-i.draggingPositionStart[1])/i.ratio;i.dragging=false;h.show()});document.getElementById("new-object-drag-position").addEventListener("click",function(){i.dragging=true;i.draggingRadius=j.value||1;i.draggingColor=E.value;h.hide()});document.getElementById("new-object-position-center").addEventListener("click",function(){g.value=-i.translation[0]*v.METERS_PER_PIXEL/i.ratio;f.value=-i.translation[1]*v.METERS_PER_PIXEL/i.ratio});document.getElementById("new-object-submit").addEventListener("click",h.submit=function(){if(h.validate()){var e=a.create(Number(g.value),Number(f.value));var t=a.create(Number(p.value),Number(y.value));var n=new d(e,Number(b.value),Number(j.value),m.value.toString());n.velocity=t;n.color=u.fromHexString(E.value);v.add(n);h.close();i.shouldRender=true}})},{"../../animation/animation.js":1,"../../animation/color.js":2,"../../content/body.js":8,"../../content/content.js":9,"../../content/vec2.js":12,"./dialog.js":24,"./length-input.js":25,"./mass-input":26,"./unsigned-length-input.js":32,"./velocity-input.js":33}],29:[function(e,t,n){var i=e("../../animation/animation.js");var o=e("../../content/content.js");var a=e("./length-input.js");var s=e("./unsigned-length-input.js");var r=e("./mass-input");var l=e("./velocity-input.js");var c=e("../../animation/color.js");var u=e("./dialog.js");var d=e("../../ui/ui.js");var v=t.exports=new u(document.getElementById("object-dialog"));var h=document.getElementById("object-name");var m=new a(document.getElementById("object-position-x"),"position-x",0);var g=new a(document.getElementById("object-position-y"),"position-y",0);var f=new l(document.getElementById("object-velocity-x"),"velocity-x",0);var p=new l(document.getElementById("object-velocity-y"),"velocity-y",0);var y=new r(document.getElementById("object-mass"),"mass",0);var b=new s(document.getElementById("object-radius"),"radius",0);var j=document.getElementById("object-color");v.registerInput(h,m,g,f,p,y,b);v.on("drag-end",function(){m.value=(i.draggingPositionStart[0]-i.translation[0]-i.canvas.width/2)*o.METERS_PER_PIXEL/i.ratio;g.value=(i.draggingPositionStart[1]-i.translation[1]-i.canvas.height/2)*o.METERS_PER_PIXEL/i.ratio;f.value=(i.draggingPositionEnd[0]-i.draggingPositionStart[0])/i.ratio;p.value=(i.draggingPositionEnd[1]-i.draggingPositionStart[1])/i.ratio;i.dragging=false;v.show()});document.getElementById("object-drag-position").addEventListener("click",function(){i.dragging=true;i.draggingRadius=b.value||1;i.draggingColor=j.value;v.hide()});document.getElementById("object-position-center").addEventListener("click",function(){m.value=(-i.translation[0]*o.METERS_PER_PIXEL/i.ratio).toExponential(3);g.value=(-i.translation[1]*o.METERS_PER_PIXEL/i.ratio).toExponential(3)});v.setValues=function(){var e=o.editedObject;j.value=e.color.hexString();v.set({name:e.name||"Object #"+e.id,"position-x":e.position[0].toExponential(3),"position-y":e.position[1].toExponential(3),"velocity-x":e.velocity[0].toExponential(3),"velocity-y":e.velocity[1].toExponential(3),mass:e.mass.toExponential(3),radius:e.radius.toExponential(3)})};document.getElementById("object-submit").addEventListener("click",v.submit=function(){if(v.validate()){var e=o.editedObject;e.name=h.value;e.position[0]=Number(m.value);e.position[1]=Number(g.value);e.velocity[0]=Number(f.value);e.velocity[1]=Number(p.value);e.mass=Number(y.value);e.radius=Number(b.value);e.color=c.fromHexString(j.value);e.clearHistory();v.close();d.update();i.shouldRender=true}})},{"../../animation/animation.js":1,"../../animation/color.js":2,"../../content/content.js":9,"../../ui/ui.js":36,"./dialog.js":24,"./length-input.js":25,"./mass-input":26,"./unsigned-length-input.js":32,"./velocity-input.js":33}],30:[function(e,t,n){var i=e("../../serialization/deserializer.js");var o=e("./dialog.js");var a=e("../../scenes/list.js");var s=t.exports=new o(document.getElementById("scene-dialog"));var r=document.getElementById("drop-area");var l=document.getElementById("deserialize-file");var c=document.getElementById("scene-name");var u=document.getElementById("scene-description");var d=new FileReader;var v=document.getElementById("deserialize-select");var h=document.getElementById("deserialize-default");var m=document.getElementById("deserialize-file-item");var g=document.getElementById("invalid-scene");var f=document.getElementById("invalid-scene-message");var p=/^.*\.json$/;var y=null;l.value="";s.showError=function(e){f.textContent="Could not load the selected scene: "+e;g.classList.remove("hidden")};s.hideError=function(e){g.classList.add("hidden")};a.forEach(function(e){var t=document.createElement("option");t.value=e.meta.name;t.textContent=e.meta.name;h.appendChild(t)});l.addEventListener("change",function(){m.classList.remove("hidden");d.onload=function(){b(d.result)};if(l.files[0]){d.readAsText(l.files[0])}});v.addEventListener("change",function(){if(v.selectedIndex===0){m.classList.remove("hidden");d.onload=function(){b(d.result)};if(l.files[0]){d.readAsText(l.files[0])}}else{m.classList.add("hidden");var e=a[v.selectedIndex-1];c.textContent=e.meta.name||sceneNames[v.selectedIndex-1];u.textContent=e.meta.description||c.textContent;s.hideError();y=e}});r.addEventListener("drop",function(e){e.stopPropagation();e.preventDefault();var t=Array.from(e.dataTransfer.files);var n=void 0;for(n in t){var i=t[n];if(i.type==="text/json"||p.test(i.name)){d.readAsText(i);d.onload=function(){b(d.result)};return}}});r.addEventListener("dragover",function(e){e.preventDefault()});r.addEventListener("dragend",function(e){var t=e.dataTransfer;if(t.items){var n=t.items;var i=void 0;for(i in n){var o=n[i];n.remove(i)}}else{e.dataTransfer.clearData()}});var b=function e(t){var n=void 0;try{n=JSON.parse(t)}catch(e){s.showError("Error parsing the selected file: "+e.message);y=null;return}if(i.validateData(n)){y=n;c.textContent=n.meta.name||"User defined scene";u.textContent=n.meta.description||c.textContent;s.hideError()}else{y=null;s.showError("Error: Invalid scene.")}};document.getElementById("load-scene").addEventListener("click",s.submit=function(){if(y){i.selectScene(y);s.close();s.hideError()}})},{"../../scenes/list.js":15,"../../serialization/deserializer.js":19,"./dialog.js":24}],31:[function(e,t,n){var i=e("../../animation/animation.js");var o=e("../../content/content.js");var a=e("./dialog.js");var s=e("../../ui/ui.js");var r=t.exports=new a(document.getElementById("settings-dialog"));var l=document.getElementById("settings-translation-x");var c=document.getElementById("settings-translation-y");var u=document.getElementById("settings-scaling-factor");var d=document.getElementById("settings-draw-history");var v=document.getElementById("settings-draw-controls");var h=document.getElementById("settings-draw-labels");var m=document.getElementById("settings-time-factor");d.checked=true;v.checked=true;h.checked=false;r.registerInput(l,c,u,m);r.setFilterFunction(u,a.greaterThanZero);r.setFilterFunction(m,a.greaterThanZero);r.on("drag-end",function(){l.value=(i.translation[0]+i.draggingPositionEnd[0]-i.canvas.width/2).toExponential(3);c.value=(i.translation[1]+i.draggingPositionEnd[1]-i.canvas.height/2).toExponential(3);i.dragging=false;i.draggingCenter=false;i.shouldRender=true;r.show()});document.getElementById("settings-drag-center").addEventListener("click",function(){i.dragging=true;i.draggingColor="#3477CC";i.draggingCenter=true;r.hide()});r.setValues=function(){d.checked=i.drawHistory;v.checked=i.drawControls;h.checked=i.drawLabels;r.set({"translation-x":i.translation[0].toExponential(3),"translation-y":i.translation[1].toExponential(3),"scaling-factor":i.ratio.toExponential(3),"time-factor":o.TIME_FACTOR.toExponential(3)})};document.getElementById("center-viewport").addEventListener("click",function(){i.translation[0]=l.value=0;i.translation[1]=c.value=0;s.selectedObject=null});document.getElementById("settings-submit").addEventListener("click",r.submit=function(){if(r.validate()){i.translation[0]=Number(l.value);i.translation[1]=Number(c.value);i.ratio=Number(u.value);i.drawHistory=d.checked;i.drawControls=v.checked;i.drawLabels=h.checked;r.close();o.TIME_FACTOR=Number(m.value);i.shouldRender=true}})},{"../../animation/animation.js":1,"../../content/content.js":9,"../../ui/ui.js":36,"./dialog.js":24}],32:[function(e,t,n){var i=e("./length-input.js");t.exports=function(e){_inherits(t,e);function t(e,n,i){_classCallCheck(this,t);return _possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}_createClass(t,[{key:"checkValidity",value:function e(){var t=this.value>0;if(t){this._inputElement.classList.remove("dialog-input-invalid")}else{this._inputElement.classList.add("dialog-input-invalid")}return t}}]);return t}(i)},{"./length-input.js":25}],33:[function(e,t,n){var i=e("./multi-unit-input.js");t.exports=function(e){_inherits(t,e);function t(e,n,i){_classCallCheck(this,t);var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,"m/s",1,"meter per second"));o.addUnit("km/h",1/3.6,"kilometer per hour");o.addUnit("c",299792458,"proportion of speed of light");return o}return t}(i)},{"./multi-unit-input.js":27}],34:[function(e,t,n){var i=e("../animation/animation.js");var o=e("../content/content.js");var a=e("../astrosim.js"),s=a.mainLoop;var r=e("../serialization/serializer.js");var l=e("../ui/ui.js");t.exports=function(){var e=this;document.getElementById("serialize-button").addEventListener("click",function(){var e=r.createData();r.serialize(e)},{passive:true});this.togglePauseButton.addEventListener("click",function(){if(s.running){l.pause()}else{l.unpause()}},{passive:true});document.getElementById("open-new-object-dialog").addEventListener("click",this.dialogs.newObjectDialog.open.bind(this.dialogs.newObjectDialog),{passive:true});document.getElementById("open-about").addEventListener("click",this.dialogs.aboutDialog.open.bind(this.dialogs.aboutDialog),{passive:true});document.getElementById("open-details").addEventListener("click",function(){l.updateHistory();e.dialogs.detailsDialog.open()},{passive:true});document.getElementById("object-delete").addEventListener("click",function(){var t=o.editedObject;o.remove(t);e.update();i.shouldRender=true;e.dialogs.objectDialog.close()},{passive:true});document.getElementById("object-cancel").addEventListener("click",this.dialogs.objectDialog.close.bind(this.dialogs.objectDialog));document.getElementById("new-object-cancel").addEventListener("click",this.dialogs.newObjectDialog.close.bind(this.dialogs.newObjectDialog));document.getElementById("open-settings-dialog").addEventListener("click",function(){var t=e.dialogs.settingsDialog;t.setValues();t.open()},{passive:true});document.getElementById("open-scene").addEventListener("click",this.dialogs.sceneDialog.open.bind(this.dialogs.sceneDialog));document.getElementById("cancel-scene").addEventListener("click",function(){e.dialogs.sceneDialog.hideError();e.dialogs.sceneDialog.close()},{passive:true});document.getElementById("settings-cancel").addEventListener("click",this.dialogs.settingsDialog.close.bind(this.dialogs.settingsDialog),{passive:true});var t=document.getElementById("open-side-bar");t.addEventListener("click",l.openSideBar.bind(l));document.getElementById("close-side-bar").addEventListener("click",function(){l.closeSideBar();t.focus()},{passive:true});l.keyboard.on("Enter",function(){if(l.dialogs.openDialog){l.dialogs.openDialog.submit()}else if(document.activeElement===document.body){if(s.running){l.pause()}else{l.unpause()}}});l.keyboard.on("i",function(){if(s.running){l.pause()}else{l.unpause()}});l.keyboard.on("keyup",function(e){if(l.dialogs.openDialog){return}var t=Number(e.key);if(t===0&&e.key!==" "){t=10}if(t>0&&t<11){if(o.objects[t-1]){if(!l.keyboard.isKeyPressed("o")){l.addObjectToSelection(o.objects[t-1])}else{l.openEditObject(o.objects[t-1])}}}});l.keyboard.on("a",function(){if(!l.dialogs.openDialog){l.dialogs.newObjectDialog.open()}});l.keyboard.on("s",function(){if(!l.dialogs.openDialog){l.dialogs.sceneDialog.open()}});l.keyboard.on("q",function(e){if(!l.dialogs.openDialog){l.selectedObjects=[];l.updateSelection()}});l.keyboard.on("p",function(){if(!l.dialogs.openDialog){l.dialogs.settingsDialog.open()}});l.keyboard.on("x",function(){if(i.dragging&&l.dialogs.openDialog){i.dragging=false;l.dialogs.openDialog.show()}});l.keyboard.on("Escape",function(){if(l.dialogs.openDialog){l.dialogs.openDialog.close()}});l.keyboard.on("n",function(){if(document.activeElement===document.body){l.toggleSideBar()}});l.keyboard.on("m",function(){if(!l.dialogs.openDialog){i.translation[0]=0;i.translation[1]=0;i.shouldRender=true}})}},{"../animation/animation.js":1,"../astrosim.js":7,"../content/content.js":9,"../serialization/serializer.js":20,"../ui/ui.js":36}],35:[function(e,t,n){var i=e("../content/event-emitter.js");t.exports=function(e){_inherits(t,e);function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.pressedKeys={};document.addEventListener("keydown",function(t){e.pressedKeys[t.key]=true;e.emit("keydown",t)},{passive:true});document.addEventListener("keyup",function(t){e.pressedKeys[t.key]=false;e.emit(t.key,t);e.emit("keyup",t)});return e}_createClass(t,[{key:"isKeyPressed",value:function e(t){return!!this.pressedKeys[t]}}]);return t}(i)},{"../content/event-emitter.js":10}],36:[function(e,t,n){var i=e("../astrosim.js");var o=i.mainLoop;var a=void 0;var s=e("./keyboard.js");var r=e("../content/body.js");var l=e("../animation/animation.js");var c=t.exports=i.ui={selectedObjects:[],historyObject:null,isPlaying:true,dialogs:e("./dialogs/dialog-manager.js"),keyboard:new s,sideBar:null,initialize:function t(){this.list=document.getElementById("object-list");this.historyTable=document.getElementById("history");this.togglePauseButton=document.getElementById("toggle-pause-button");this.sideBar=document.getElementById("side-bar");a=e("../content/content.js");this.dialogs.initialize();e("./event-listeners.js").call(this)},update:function e(){var t=void 0;var n=this.list;while(n.firstChild){n.removeChild(n.firstChild)}var i=document.createDocumentFragment();var o=a,s=o.objects;for(t in s){var r=s[t];var l=document.createElement("div");l.classList.add("object-list-item");var u=document.createElement("div");u.classList.add("object-list-item-before");u.style.backgroundColor=r.color.hexString();var d=document.createElement("span");d.appendChild(u);d.appendChild(document.createTextNode(r.name||"Object #"+r.id));var v=document.createElement("button");v.classList.add("edit-button");v.addEventListener("click",c.openEditObject.bind(c,r));var h=document.createElement("button");h.classList.add("center-button");h.addEventListener("click",c.addObjectToSelection.bind(c,r));var m=document.createElement("div");m.appendChild(v);m.appendChild(h);l.appendChild(d);l.appendChild(m);i.appendChild(l)}n.appendChild(i);this.updateSelection()},addObjectToSelection:function e(t){var n=this.selectedObjects;var i=void 0;if((i=n.indexOf(t))>-1){n.splice(i,1)}else{n.push(t)}this.updateSelection();l.shouldRender=true},openEditObject:function e(t){a.editedObject=t;var n=this.dialogs.objectDialog;n.setValues();n.open()},updateSelection:function e(){var t=c.selectedObjects;var n=t.map(function(e,t){return e.id});var i=this.list;var o=Array.from(i.children);var a=o.length;var s=void 0;for(s in o){var r=o[s];if(n.indexOf(Number(s))>-1){r.classList.add("selected-object")}else{r.classList.remove("selected-object")}}},updateHistory:function e(){var t=a,n=t.objects;var i=this.historyTable;var o=i.firstChild.nextElementSibling.nextElementSibling;while(o){var s=o;o=s.nextSibling;i.removeChild(s)}var r=0,l=0;for(r in n){var u=document.createElement("tr");var d=n[r];for(l=0;l<7;l+=1){var v=document.createElement("td");u.appendChild(v)}var h=document.createElement("span");h.classList.add("details-list-item-before");h.style.backgroundColor=d.color.hexString();h.addEventListener("click",c.updateHistoryValues.bind(c,d));var m=document.createElement("span");m.textContent=d.name;u.children[0].appendChild(h);u.children[0].appendChild(m);i.appendChild(u)}this.updateHistoryValues()},updateHistoryValues:function e(t){var n=a,i=n.objects;if(!t){return}var o=void 0;var s=i.length;for(o=0;o<s;o+=1){var r=this.historyTable.children[o+1];if(o===t.id){r.children[1].textContent="-";r.children[2].textContent="-";r.children[3].textContent="-";r.children[4].textContent="-";r.children[5].textContent="-";r.children[6].textContent="-"}else{var l=a.histories[t.id][o];r.children[1].textContent=l.force.average.toExponential(3);r.children[2].textContent=l.force.min.toExponential(3);r.children[3].textContent=l.force.max.toExponential(3);r.children[4].textContent=l.distance.average.toExponential(3);r.children[5].textContent=l.distance.min.toExponential(3);r.children[6].textContent=l.distance.max.toExponential(3)}}},pause:function e(){if(l.dragging){return}l.pause();this.isPlaying=false;this.togglePauseButton.textContent="Play";this.togglePauseButton.classList.add("play-button");this.togglePauseButton.classList.remove("pause-button")},unpause:function e(){if(l.dragging){return}l.unpause();this.isPlaying=true;this.togglePauseButton.textContent="Pause";this.togglePauseButton.classList.remove("play-button");this.togglePauseButton.classList.add("pause-button")},openSideBar:function e(){this.sideBar.classList.remove("side-bar-closed")},closeSideBar:function e(){this.sideBar.classList.add("side-bar-closed")},toggleSideBar:function e(){if(this.sideBar.classList.contains("side-bar-closed")){this.sideBar.classList.remove("side-bar-closed")}else{this.sideBar.classList.add("side-bar-closed")}}}},{"../animation/animation.js":1,"../astrosim.js":7,"../content/body.js":8,"../content/content.js":9,"./dialogs/dialog-manager.js":23,"./event-listeners.js":34,"./keyboard.js":35}]},{},[7]);
>>>>>>> 0fc4633b679415267b3a4731caeb4a67297bbbbe
